<process name="Email Classification_NC" version="1.0" bpversion="6.10.1.35171" narrative="Email Classification Process is for reading the third party supplier name in the mail and checking the vendor name in the master excel file and forwards the original mail to the specific contractor mail id" byrefcollection="true" preferredid="3f700e54-856c-449c-bea0-6aac2a2d3ba7">
  <view>
    <camerax>-86</camerax>
    <cameray>-741</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="4b4b2c48-009a-4411-8d3e-96b41ddde853" type="Normal" published="False">
    <name>Read Excel</name>
    <view>
      <camerax>-21</camerax>
      <cameray>30</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="eddf0342-6873-42bd-88c6-0dd0c66abd06" type="Normal" published="False">
    <name>Populate Queue</name>
    <view>
      <camerax>15</camerax>
      <cameray>-742</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f23ced7f-3421-4b49-8c98-300ca324b087" type="Normal" published="False">
    <name>Populate Queue - Copy</name>
    <view>
      <camerax>82</camerax>
      <cameray>-809</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e311f5fd-8469-4a14-b402-9267a5d39ffb" type="Normal" published="False">
    <name>Checking the Vendor name in the excel and Forwarding the mail</name>
    <view>
      <camerax>63</camerax>
      <cameray>-441</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="270d450b-e968-4a72-929d-803d10468bcd" type="Normal" published="False">
    <name>Mail Sending</name>
    <view>
      <camerax>144</camerax>
      <cameray>315</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c10b0887-463e-428e-ba34-965b06fe4bdd" type="Normal" published="False">
    <name>Contruct and Send Email</name>
    <view>
      <camerax>35</camerax>
      <cameray>195</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="72d613cd-4350-46a5-942e-7630c91dcf17" type="Normal" published="False">
    <name>Get Workqueue Report</name>
    <view>
      <camerax>264</camerax>
      <cameray>-304</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="2167e0d0-c563-4e25-82ce-25ce1ecc006d" type="Normal" published="False">
    <name>Contruct and Send Email - table template</name>
    <view>
      <camerax>183</camerax>
      <cameray>30</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="3c155e8f-53fe-4345-8fd6-544621f71a76" name="Start" type="Start">
    <display x="0" y="-870" w="120" h="60" />
    <onsuccess>b7643550-2a30-4fd5-a95e-828c4154fe05</onsuccess>
  </stage>
  <stage stageid="b96ebdcb-6d7f-4bcc-97ae-0772891d1077" name="Stage1" type="ProcessInfo">
    <display x="-615" y="-990" w="240" h="120" />
  </stage>
  <stage stageid="c6659ed5-30cd-45de-a3c9-4e7eeaa91dba" name="Read Excel" type="SubSheetInfo">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-405" y="-330" w="150" h="90" />
  </stage>
  <stage stageid="665cff1b-7cdc-4c28-a3bb-5c70eb4231a6" name="Start" type="Start">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="-165" w="120" h="60" />
    <onsuccess>8a82980c-991d-4953-a269-07d88ac99f28</onsuccess>
  </stage>
  <stage stageid="9e70ca93-0335-4a87-bfe2-0a827f2e82cb" name="End" type="End">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="345" w="120" h="60" />
    <outputs>
      <output type="collection" name="Resellers Collection" stage="Resellers Collection" />
      <output type="collection" name="OEM  Collection" stage="OEM  Collection" />
    </outputs>
  </stage>
  <stage stageid="5ef9c8fc-589e-481f-b08e-f0fbf1e42910" name="Email Classification Process_Excel_Filepath" type="Data">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="405" y="-90" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\BP_files\Resellers  Direct SW Agreements 24 June 20-- emails.xlsx</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8a82980c-991d-4953-a269-07d88ac99f28" name="MS Excel VBO::Create Instance" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="-75" w="120" h="60" />
    <inputs>
      <input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" />
    </outputs>
    <onsuccess>ee0d24dd-23f9-427d-a3aa-db4ce9c891e8</onsuccess>
    <resource object="MS Excel VBO" action="Create Instance" />
  </stage>
  <stage stageid="0a34fa71-9e73-4149-a7e9-bb7b17414b77" name="handle" type="Data">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="405" y="-135" w="90" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ee0d24dd-23f9-427d-a3aa-db4ce9c891e8" name="MS Excel VBO::Open Workbook" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="0" w="120" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[Email Classification Process_Excel_Filepath]" />
    </inputs>
    <outputs>
      <output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" />
    </outputs>
    <onsuccess>cf49c88c-6f28-48cf-851a-a1072119910d</onsuccess>
    <resource object="MS Excel VBO" action="Open Workbook" />
  </stage>
  <stage stageid="4678da16-f850-444b-9444-e5befe8dc047" name="Workbook Name" type="Data">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="495" y="-135" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cf49c88c-6f28-48cf-851a-a1072119910d" name="MS Excel VBO::Get Worksheet As Collection" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="90" w="120" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" />
      <input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="&quot;Resellers Only&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="Resellers Collection" />
    </outputs>
    <onsuccess>6a247699-572f-4d67-bd6d-b91afc3739ff</onsuccess>
    <resource object="MS Excel VBO" action="Get Worksheet As Collection" />
  </stage>
  <stage stageid="cc21a5ba-a718-4b45-981d-12077630a2b9" name="MS Excel VBO::Close All Instances" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="270" w="120" h="60" />
    <onsuccess>9e70ca93-0335-4a87-bfe2-0a827f2e82cb</onsuccess>
    <resource object="MS Excel VBO" action="Close All Instances" />
  </stage>
  <stage stageid="28500c2a-6a2c-4225-a630-8c393d6403fa" name="Utility - File Management::File Exists" type="Action">
    <display x="0" y="-690" w="120" h="60" />
    <inputs>
      <input type="text" name="File Name" friendlyname="File Name" narrative="The name of the file to check" expr="[Email Classification Process_Excel_Filepath]" />
    </inputs>
    <outputs>
      <output type="flag" name="Exists" friendlyname="Exists" narrative="True if the file exists" stage="Exists" />
    </outputs>
    <onsuccess>5cea8caf-3b01-4d9a-9733-841297c320fd</onsuccess>
    <resource object="Utility - File Management" action="File Exists" />
  </stage>
  <stage stageid="88d362aa-c89f-4d67-b4e2-020d88e59a8a" name="Email Classification Process_Excel_Filepath" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-540" y="-705" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\BP_files\Resellers  Direct SW Agreements 24 June 20-- emails.xlsx</initialvalue>
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="93b430fb-43e9-4274-8c45-f93b66f7bd13" name="Exists" type="Data">
    <display x="-435" y="-705" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5cea8caf-3b01-4d9a-9733-841297c320fd" name="Check file exists?" type="Decision">
    <display x="0" y="-615" w="90" h="60" />
    <decision expression="[Exists]" />
    <ontrue>00a8d734-a85d-49fe-81b7-4d1fe5576bfb</ontrue>
    <onfalse>f3dbdedd-d123-4818-aebc-b41102e13cc9</onfalse>
  </stage>
  <stage stageid="f3dbdedd-d123-4818-aebc-b41102e13cc9" name="Excel File not Found " type="Exception">
    <display x="150" y="-615" w="120" h="60" />
    <exception localized="yes" type="Business Exception" detail="&quot;Resellers File not Found &quot;" />
  </stage>
  <stage stageid="8cd2ac15-5907-4bf1-99ae-737d0e7b8f7b" name="Populate Queue - copy" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="-150" y="-405" w="120" h="60" />
    <onsuccess>54f3addb-4392-4ff2-aa2d-f6d65a6439b3</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>f23ced7f-3421-4b49-8c98-300ca324b087</processid>
  </stage>
  <stage stageid="00a8d734-a85d-49fe-81b7-4d1fe5576bfb" name="Read Excel File" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="0" y="-540" w="120" h="60" />
    <outputs>
      <output type="collection" name="Resellers Collection" friendlyname="Resellers Collection" stage="Resellers Collection" />
      <output type="collection" name="OEM  Collection" friendlyname="OEM  Collection" stage="OEM  Collection" />
    </outputs>
    <onsuccess>3098ac03-a2ab-4cf8-8826-8283fe4c0fdc</onsuccess>
    <processid>4b4b2c48-009a-4411-8d3e-96b41ddde853</processid>
  </stage>
  <stage stageid="54f3addb-4392-4ff2-aa2d-f6d65a6439b3" name="Work Queues::Get Next Item" type="Action">
    <narrative>This action gets the next item to be worked from the queue, returning its details and locking it so no other case can work it.

Items with higher priorities (lower numerical value) are processed first. Where the priority is the same, the next item is the one that has been in the queue the longest,  is not already locked, and is not already completed.

The Item ID returned is used to make further calls to update the work status for that item. It may be empty, in which case there are no items available. This can mean either a) the queue is empty, or b) the queue is not running. This mechanism can be used to cleanly stop all processes working a particular queue at the end of the next case. Items that have a 'deferred' time set will not be returned unless that time has been reached.</narrative>
    <display x="0" y="-255" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue" expr="[Work Queue Name]" />
      <input type="text" name="Key Filter" friendlyname="Key Filter" narrative="Optionally, a key value to filter by. Only items with this key value will be considered." expr="" />
      <input type="text" name="Tag Filter" friendlyname="Tag Filter" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="&quot;Ready to Start checking for vendor name&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>124f24a7-572c-4eef-9a57-ac3456bc1d1b</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Next Item" />
  </stage>
  <stage stageid="8bbc3b1b-e0eb-47ce-9510-563e87c75768" name="Item ID" type="Data">
    <display x="-570" y="-525" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="124f24a7-572c-4eef-9a57-ac3456bc1d1b" name="Checks Item ID" type="Decision">
    <display x="0" y="-165" w="120" h="60" />
    <decision expression="[Item ID]&lt;&gt;&quot;&quot;" />
    <ontrue>70c6fac5-108c-48c3-a834-06417ec52644</ontrue>
    <onfalse>946b72a3-d55d-453b-ad72-b33fff6b40ac</onfalse>
  </stage>
  <stage stageid="c420e15b-d146-4d22-95f8-4670095a2f73" name="Checking the Vendor Name in the excel and forwarding the mail" type="SubSheet">
    <display x="0" y="60" w="120" h="60" />
    <inputs>
      <input type="collection" name="Resellers Collection" friendlyname="Resellers Collection" expr="[Resellers Collection]" />
      <input type="collection" name="OEM  Collection" friendlyname="OEM  Collection" expr="[OEM  Collection]" />
    </inputs>
    <outputs>
      <output type="text" name="Result Value" friendlyname="Result Value" stage="Result Value" />
    </outputs>
    <onsuccess>70d10bb8-0c22-4188-aeae-bda5da32e842</onsuccess>
    <processid>e311f5fd-8469-4a14-b402-9267a5d39ffb</processid>
  </stage>
  <stage stageid="f49b0cef-8e6e-4f21-a002-f39899fddcc8" name="Input Collection" type="Collection">
    <display x="-555" y="-660" w="120" h="30" />
    <datatype>collection</datatype>
    <alwaysinit />
    <collectioninfo>
      <singlerow />
      <field name="Vendor Name" type="text" />
      <field name="Item Key" type="text" />
      <field name="New Item ID" type="text" />
      <field name="Project Code" type="text" />
    </collectioninfo>
    <initialvalue>
      <singlerow />
      <row>
        <field name="Vendor Name" type="text" value="" />
        <field name="Item Key" type="text" value="" />
        <field name="New Item ID" type="text" value="" />
        <field name="Project Code" type="text" value="" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="946b72a3-d55d-453b-ad72-b33fff6b40ac" name="End1" type="End">
    <loginhibit onsuccess="true" />
    <display x="120" y="-165" w="90" h="60" />
  </stage>
  <stage stageid="70c6fac5-108c-48c3-a834-06417ec52644" name="Work Queues::Get Item Data" type="Action">
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="0" y="-90" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="Data" />
    </outputs>
    <onsuccess>e5e3bc5f-6fbf-46ac-b03f-4f112d2c4b49</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="fbc7ac27-fa08-450b-8444-8879fa156182" name="Data" type="Collection">
    <display x="-495" y="-525" />
    <datatype>collection</datatype>
    <alwaysinit />
  </stage>
  <stage stageid="03d692f7-c622-4943-9a6a-e63af1044b28" name="Vendor Name" type="Data">
    <display x="-420" y="-525" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="95807568-8879-43c8-8dd8-3168d9996334" name="Member Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-615" y="-735" w="240" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3edc55dd-abff-4cf2-a6e0-a55eec5cc729" name="Member Variables" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-615" y="-555" w="240" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ebec6c0a-7971-415d-94fd-52ea0a0304ae" name="Result Value" type="Data">
    <display x="-435" y="-660" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="70d10bb8-0c22-4188-aeae-bda5da32e842" name="Checks Result Value" type="Decision">
    <display x="0" y="120" w="120" h="60" />
    <decision expression="[Result Value]=&quot;Mail Forwarding Done&quot;" />
    <ontrue>bc006810-23e2-4ffe-8252-e2da7a0b6bbb</ontrue>
    <onfalse>c9fc63fc-1f76-491e-967e-7a80d7156243</onfalse>
  </stage>
  <stage stageid="bc006810-23e2-4ffe-8252-e2da7a0b6bbb" name="Work Queues::Untag Item" type="Action">
    <narrative>Removes a tag from a work queue item</narrative>
    <display x="0" y="210" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the queue item to remove the tag from" expr="[Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" narrative="The tag to remove from the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Ready to Start checking for vendor name&quot;" />
    </inputs>
    <onsuccess>1bcc47d3-f13b-4eb3-bdc7-f75080c2b78b</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Untag Item" />
  </stage>
  <stage stageid="1bcc47d3-f13b-4eb3-bdc7-f75080c2b78b" name="Update Tag- Mail Forwading Done" type="Action">
    <narrative>Adds a tag to a work queue item</narrative>
    <display x="0" y="285" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the queue item to add the tag to" expr="[Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" narrative="The tag to add to the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Mail Forwarding Completed Successfully&quot;" />
    </inputs>
    <onsuccess>2b1c6502-d34d-40cf-b8eb-988f8db9d64b</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Tag Item" />
  </stage>
  <stage stageid="2b1c6502-d34d-40cf-b8eb-988f8db9d64b" name="Mark Completed" type="Action">
    <narrative>Marks the item as completed, by updating the Completed timestamp and setting Locked to null. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="-165" y="285" w="90" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
    </inputs>
    <onsuccess>acf85f83-61a3-424d-819b-541233e982e9</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Completed" />
  </stage>
  <stage stageid="0b973ad0-809e-4a67-8b5e-8d3ff5e93f05" name="Anchor4" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-165" y="-255" w="10" h="10" />
    <onsuccess>54f3addb-4392-4ff2-aa2d-f6d65a6439b3</onsuccess>
  </stage>
  <stage stageid="c9fc63fc-1f76-491e-967e-7a80d7156243" name="Mark Exception" type="Action">
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="390" y="120" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item ID]" />
      <input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="[Exception Type]&amp;&quot;;&quot;&amp;[Exception Message]" />
      <input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="" />
      <input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" />
    </outputs>
    <onsuccess>6a6accc6-9ed0-48af-abb4-2ae30c104a33</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="6142e13e-98f1-43a0-bd62-0cf1e6749e63" name="Anchor5" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="390" y="-255" w="10" h="10" />
    <onsuccess>54f3addb-4392-4ff2-aa2d-f6d65a6439b3</onsuccess>
  </stage>
  <stage stageid="ba2dc2c2-a335-4101-9464-407cd82ade4b" name="Main Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-270" y="-300" w="750" h="765" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="2fc9c40a-f59f-4b48-9d6b-0f90b70fd13c" name="Main Recover" type="Recover">
    <display x="165" y="285" w="120" h="60" />
    <onsuccess>a526ddae-9247-46e2-8b03-50617da9192e</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="a526ddae-9247-46e2-8b03-50617da9192e" name="Set Exceptions " type="MultipleCalculation">
    <display x="360" y="285" w="120" h="60" />
    <onsuccess>31344dc5-f0d2-4452-8f6f-ba494849dad6</onsuccess>
    <steps>
      <calculation expression="ExceptionType()" stage="Exception Type" />
      <calculation expression="ExceptionDetail()" stage="Exception Message" />
    </steps>
  </stage>
  <stage stageid="0bf62c6d-7244-4e6e-908b-4e971932da00" name="Exception Type" type="Data">
    <display x="-495" y="-480" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="661a4b00-848b-49cb-822b-500deccfb77a" name="Exception Message" type="Data">
    <display x="-555" y="-480" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="31344dc5-f0d2-4452-8f6f-ba494849dad6" name="Main Resume" type="Resume">
    <display x="555" y="285" w="90" h="60" />
    <onsuccess>69ac6b9b-529a-4600-80b4-4d74821959dc</onsuccess>
  </stage>
  <stage stageid="69ac6b9b-529a-4600-80b4-4d74821959dc" name="Anchor7" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="555" y="120" w="10" h="10" />
    <onsuccess>c9fc63fc-1f76-491e-967e-7a80d7156243</onsuccess>
  </stage>
  <stage stageid="1098c575-41fa-45be-92da-5e68811d7647" name="Excel  Variables" type="Block">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="330" y="-165" w="225" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="28ef8187-aab9-4934-b7c0-9d960d573029" name="New Item ID" type="Data">
    <display x="-420" y="-480" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a232cd56-9bf4-4ca2-a87a-5ee65bbc0407" name="Mail Sending" type="SubSheetInfo">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="-435" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="86ce2da0-0ec7-4d19-8ef1-42b82a5f327e" name="Start" type="Start">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <narrative>Input parametetrs</narrative>
    <display x="-30" y="-90" w="120" h="60" />
    <inputs>
      <input type="text" name="In To Mail" stage="To Mail" />
      <input type="text" name="In Mail CC" stage="Mail CC" />
      <input type="text" name="In Subject" stage="Email Subject" />
      <input type="text" name="In Message Body" stage="Message Body" />
      <input type="text" name="In Attachments" stage="Attachments" />
    </inputs>
    <onsuccess>70d494c4-2d43-45eb-a818-f7f59f125d5e</onsuccess>
  </stage>
  <stage stageid="8a9f562a-f6ce-46c3-88b4-6bf06e52ec25" name="End" type="End">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-30" y="315" />
  </stage>
  <stage stageid="70d494c4-2d43-45eb-a818-f7f59f125d5e" name="Configure" type="Action">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-30" y="75" w="120" h="60" />
    <inputs>
      <input type="flag" name="UseWindowsCredentials" friendlyname="UseWindowsCredentials" narrative="Use Windows credentials of currently logged on user instead of providing separate credentials" expr="[Use Windows Credtinials]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to authenticate with Exchange " expr="[Username]" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to authenticate with Exchange " expr="[Password]" />
    </inputs>
    <onsuccess>bd6012fb-0f0f-4aee-8c7a-fa4af741da79</onsuccess>
    <resource object="Email - Exchange Managed API" action="Configure" />
  </stage>
  <stage stageid="bd6012fb-0f0f-4aee-8c7a-fa4af741da79" name="Send   Mail Message" type="Action">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="-30" y="150" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="FF00FF" />
    <inputs>
      <input type="text" name="To" friendlyname="To" narrative="The email address of the recipient. To address multiple recipients use the format &quot;john.smith@example.com;henry.jones@example.com&quot;." expr="[To Mail]" />
      <input type="text" name="BCC" friendlyname="BCC" expr="[BCC]" />
      <input type="text" name="CC" friendlyname="CC" narrative="The email address of the CC recipient. To address multiple recipients use the format &quot;john.smith@example.com; henry.jones@example.com&quot;." expr="[Mail CC]" />
      <input type="text" name="Subject" friendlyname="Subject" narrative="The subject of the email." expr="[Subject]" />
      <input type="text" name="Message" friendlyname="Message" narrative="The body of the email." expr="[Message Body]" />
      <input type="text" name="Attachments" friendlyname="Attachments" narrative="Text containing a list of files to add to the email as attachments, Seperated by Semicolon." expr="[Attachments]" />
      <input type="flag" name="BodyIsHTML" friendlyname="BodyIsHTML" narrative="Indicates if the body should be sent as HTML" expr="[Body is HTML ]" />
    </inputs>
    <outputs>
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Mail GUID" friendlyname="Mail GUID" stage="Mail GUID" />
    </outputs>
    <onsuccess>9e4ef911-257e-46dc-9c78-f28a6f3faaae</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <resource object="Email - Exchange Managed API" action="Send Mail" />
  </stage>
  <stage stageid="008b1a44-ac33-4757-9f81-ea2ebf6a8a24" name="Creditinals" type="Block">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-630" y="-120" w="270" h="180" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="badeda9e-8355-4271-8b16-db9d62188297" name="Credentials  Name" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-555" y="-75" w="120" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="0000FF" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4601037e-1ea7-43a2-8aab-8899ac984ef5" name="Expiry Date" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="-420" y="30" w="120" h="30" />
    <datatype>date</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a10b2b40-f05d-40e5-8411-8683ef070ab5" name="Status" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="-555" y="30" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e1979880-bc26-48bd-8576-659e27f5d6e4" name="Unable to send  Exception Mail " type="Exception">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="135" y="240" w="90" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="FF0000" />
    <exception localized="yes" type="&quot;Mail_exception&quot;" detail="&quot;Unable to send  Exception Mail Message&quot;" />
  </stage>
  <stage stageid="9e4ef911-257e-46dc-9c78-f28a6f3faaae" name="Sending Mail Status" type="Decision">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="-30" y="240" w="60" h="60" />
    <font family="Segoe UI" size="10" style="Bold" color="000000" />
    <decision expression="[Error Message]&lt;&gt;&quot;&quot;" />
    <ontrue>e1979880-bc26-48bd-8576-659e27f5d6e4</ontrue>
    <onfalse>8a9f562a-f6ce-46c3-88b4-6bf06e52ec25</onfalse>
  </stage>
  <stage stageid="20c86827-d860-48b4-abc1-9e162c4dc479" name="Use Windows Credtinials" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-570" y="-15" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="ff3e8520-910a-4702-b541-d2c58350394a" name="Inputs" type="Block">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="285" y="-135" w="285" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="FFFF99" />
  </stage>
  <stage stageid="2ae2acb1-b4ef-4f08-b08e-00d85e89201c" name="Outputs" type="Block">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="315" y="240" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="008000" />
  </stage>
  <stage stageid="7ab2c7d8-86aa-4ad2-a53a-9f26ff9c4bef" name="Mail GUID" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="345" y="285" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="50d430e6-8148-4584-9c5e-5ec27fb9b9d9" name="Success" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="435" y="330" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ec02776a-640e-4ce0-b35f-6f1e62050cf0" name="Error Message" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="435" y="285" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b4166e64-6104-4525-94b0-0ed906d43404" name="Exception Message" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="360" y="330" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3f2d246a-1acc-4679-989e-1f94d5b5cccb" name="To Mail" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="420" y="-105" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">pr7@avaya.com</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="782175f4-d1dc-49de-9a69-8615cba48b48" name="BCC" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="330" y="45" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3cdf79d6-1cfa-4ce1-b9d6-33e6ea485a63" name="Email Subject" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="420" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Json files</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e67f58a9-ea11-4d4a-b7cc-cdebf73f236e" name="Message Body" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="420" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">FYI</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0fade232-e709-4e28-a8f3-42e15333e5a6" name="Attachments" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="390" y="45" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1dbb7438-6518-4e7e-8a94-5151e25b13ff" name="Body is HTML " type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="465" y="45" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="53799ded-9e22-49b6-bb55-2f8775257a40" name="Mail CC" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <display x="525" y="0" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c45eba76-9596-4bde-bac6-eba2161516d5" name="Send Mail Resume" type="Resume">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-255" y="315" />
    <onsuccess>8a9f562a-f6ce-46c3-88b4-6bf06e52ec25</onsuccess>
  </stage>
  <stage stageid="3cf3a404-6419-4711-a5b2-9a410ccad690" name="Send Mail Recover" type="Recover">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit />
    <display x="-255" y="195" />
    <onsuccess>c45eba76-9596-4bde-bac6-eba2161516d5</onsuccess>
  </stage>
  <stage stageid="ef432388-4d4d-4a7d-99dd-0931e217bb93" name="Password" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <narrative>S5Eu6eYzhbJSSdgwL6VETBj4YBdmNCGVQXxS</narrative>
    <display x="-465" y="-75" />
    <datatype>password</datatype>
    <initialvalueenc>8,26,4,85,21,116,69,87,114,65</initialvalueenc>
  </stage>
  <stage stageid="b27714c9-3bb0-49d6-9510-670b2718f16f" name="Username" type="Data">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <narrative>svcrpaoceana01@avaya.com
svcrpagso@avaya.com </narrative>
    <display x="-390" y="-75" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">nachimuthus@avaya.com</initialvalue>
  </stage>
  <stage stageid="6a6accc6-9ed0-48af-abb4-2ae30c104a33" name="Contruct and Send Email" type="SubSheet">
    <display x="390" y="-45" w="120" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="[Exception Type]" />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="" />
    </inputs>
    <onsuccess>6142e13e-98f1-43a0-bd62-0cf1e6749e63</onsuccess>
    <processid>c10b0887-463e-428e-ba34-965b06fe4bdd</processid>
  </stage>
  <stage stageid="8c1512a2-d002-46e6-a40c-2d37ae092da7" name="Excel Block" type="Block">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-120" w="480" h="345" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="ebf69c63-4c96-40c6-bb54-7fd1cb6584fb" name="Excel Recover" type="Recover">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="30" y="150" w="120" h="60" />
    <onsuccess>a0d416fd-f1f3-47c8-a7e3-e8cf4590cc22</onsuccess>
  </stage>
  <stage stageid="4846838f-3f7f-415b-be0f-3ad5b2735782" name="Exception Message" type="Data">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="495" y="-90" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f5868f20-7ab9-4f9d-8599-bb8697ee85cf" name="Excel Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-285" y="-735" w="780" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="12601c86-afa1-443a-a9ad-3251fbc796d5" name="Main Recover" type="Recover">
    <display x="315" y="-555" w="120" h="60" />
    <onsuccess>78c673f8-7671-4e33-9b66-15c14a7bc9cc</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="78c673f8-7671-4e33-9b66-15c14a7bc9cc" name="Set Exceptions " type="MultipleCalculation">
    <display x="435" y="-555" w="90" h="60" />
    <onsuccess>8023fb64-f500-4d06-bcbd-707ee559bd43</onsuccess>
    <steps>
      <calculation expression="ExceptionType()" stage="Exception Type" />
      <calculation expression="ExceptionDetail()" stage="Exception Message" />
    </steps>
  </stage>
  <stage stageid="8023fb64-f500-4d06-bcbd-707ee559bd43" name="Main Resume" type="Resume">
    <loginhibit />
    <display x="570" y="-555" w="90" h="60" />
    <onsuccess>2cc57b6b-9113-48bd-92fb-3170243715f8</onsuccess>
  </stage>
  <stage stageid="2cc57b6b-9113-48bd-92fb-3170243715f8" name="Contruct and Send Email" type="SubSheet">
    <display x="570" y="-645" w="120" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="[Exception Type]" />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="" />
    </inputs>
    <onsuccess>dfb481b0-5c8d-44bc-b58e-4ce4f2e037c9</onsuccess>
    <processid>c10b0887-463e-428e-ba34-965b06fe4bdd</processid>
  </stage>
  <stage stageid="dfb481b0-5c8d-44bc-b58e-4ce4f2e037c9" name="End2" type="End">
    <loginhibit onsuccess="true" />
    <display x="570" y="-735" w="120" h="60" />
  </stage>
  <stage stageid="acf85f83-61a3-424d-819b-541233e982e9" name="Anchor9" type="Anchor">
    <loginhibit onsuccess="true" />
    <display x="-165" y="60" w="10" h="10" />
    <onsuccess>0b973ad0-809e-4a67-8b5e-8d3ff5e93f05</onsuccess>
  </stage>
  <stage stageid="761ca5b6-5fb2-4c95-8b88-b4452bbc2aa4" name="Resellers Collection" type="Collection">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-465" y="15" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a247699-572f-4d67-bd6d-b91afc3739ff" name="MS Excel VBO::Get Worksheet As Collection" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-120" y="180" w="120" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet which should be retrieved resides. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which contains the sheet required. The default empty text indicates the currently active workbook on the specified instance." expr="[Workbook Name]" />
      <input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet within the specified workbook which should be written to a collection. The default empty text indicates the currently active worksheet within the specified workbook." expr="&quot;OEM &amp; other Direct Suppliers&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Data" friendlyname="Data" narrative="The collection containing the data from the specified worksheet - the column IDs will be gleaned from the first row on the sheet being retrieved." stage="OEM  Collection" />
    </outputs>
    <onsuccess>cc21a5ba-a718-4b45-981d-12077630a2b9</onsuccess>
    <resource object="MS Excel VBO" action="Get Worksheet As Collection" />
  </stage>
  <stage stageid="afd950d6-610d-4066-986a-20150365ad09" name="OEM  Collection" type="Collection">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-405" y="15" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6ea071e9-e920-4444-b8ec-45452f09d34d" name="Exception Type" type="Data">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="-435" y="-30" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="48f0c01a-cb51-480a-b9c7-089ee8664b4d" name="Get Workqueue Report" type="SubSheetInfo">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-390" y="-390" w="150" h="90" />
  </stage>
  <stage stageid="36f84ee6-065b-43ed-8adb-c2b48435aabd" name="Start" type="Start">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="0" y="-555" w="90" h="60" />
    <onsuccess>e3cbb205-3d68-4fef-8ead-4dec5b59eb8a</onsuccess>
  </stage>
  <stage stageid="1638add6-7442-471a-b6c7-d2df9a8e0527" name="WorkQueue Name" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-420" y="-180" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Email Classification</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4b517bbf-7337-43cf-a274-281352ddf50e" name="Item Count" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="330" y="-360" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="4fe857b6-1555-4295-8251-c6e26868b9bf" name="Item IDs" type="Collection">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="255" y="-360" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="b4a73eba-8496-4bf8-a700-ed4b76538099" name="Item IDs" type="LoopStart">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-330" w="90" h="60" />
    <onsuccess>63a1faa3-4a4a-4d04-9b29-8fccf883a7c3</onsuccess>
    <groupid>4c84b395-3e01-49d2-afe0-bf08af4df52c</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Item IDs</loopdata>
  </stage>
  <stage stageid="2f8bb03f-08d9-4d64-9d47-71b687bae760" name="Item IDs" type="LoopEnd">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-45" w="90" h="60" />
    <onsuccess>a4378505-4938-468b-852f-6aa3d478bed9</onsuccess>
    <groupid>4c84b395-3e01-49d2-afe0-bf08af4df52c</groupid>
  </stage>
  <stage stageid="63a1faa3-4a4a-4d04-9b29-8fccf883a7c3" name="Work Queues::Get Item Data" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get data relating to an item in a queue. You do not need to have a lock on the item to do this.</narrative>
    <display x="0" y="-255" w="90" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to get data from. An error will be raised if this item does not exist." expr="[Item IDs.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Key" friendlyname="Key" narrative="The key value of the item." stage="Key" />
      <output type="number" name="Priority" friendlyname="Priority" narrative="The priority of the item" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
      <output type="timespan" name="Worktime" friendlyname="Worktime" narrative="The total time spent on this item (including previous attempts)" stage="Worktime" />
      <output type="timespan" name="Attempt Worktime" friendlyname="Attempt Worktime" narrative="The amount of time spent on this particular attempt of the item" stage="" />
      <output type="datetime" name="Loaded DateTime" friendlyname="Loaded DateTime" narrative="The date and time at which this item was first loaded into the queue." stage="" />
      <output type="datetime" name="Deferred DateTime" friendlyname="Deferred DateTime" narrative="The date and time at which this item has been deferred to. Empty if this item has not been deferred." stage="" />
      <output type="datetime" name="Completed DateTime" friendlyname="Completed DateTime" narrative="The date and time at which this item was marked as complete. Empty if this item has not been marked as complete" stage="" />
      <output type="datetime" name="Exception DateTime" friendlyname="Exception DateTime" narrative="The date and time at which this item was marked as an exception. Empty if there has never been an exception on this item." stage="" />
      <output type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="The exception reason recorded against this item." stage="" />
      <output type="text" name="Tags" friendlyname="Tags" narrative="The semi-colon separated set of tags which apply to the item. " stage="" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
    </outputs>
    <onsuccess>b4b0ff02-76c7-44df-b72c-d1485dc3ee6a</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item Data" />
  </stage>
  <stage stageid="ffc7fa67-5381-429b-903c-d01447aadf92" name="Worktime" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="255" y="-315" />
    <datatype>timespan</datatype>
    <initialvalue>0.00:00:00</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="79e4aed3-990a-46f4-8752-dd1df18ab3cb" name="Loaded DateTime" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>10/14/2020 11:59:59 AM</narrative>
    <display x="-345" y="-180" />
    <datatype>datetime</datatype>
    <initialvalue>2020-10-14 11:59:59Z</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="06e42663-e417-47d0-afbd-10165a7fe91f" name="Work Queues::Get Report Data" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Retrieves queue data for analysis. The queue name and at least one of the date parameters must be provided when calling this action</narrative>
    <display x="0" y="-405" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue for which the details are required. This parameter is mandatory" expr="[WorkQueue Name]" />
      <input type="datetime" name="Finished Start Date" friendlyname="Finished Start Date" narrative="The item finish (complete or exception) date/time to start results" expr="" />
      <input type="datetime" name="Finished End Date" friendlyname="Finished End Date" narrative="The item finish (complete or exception) date/time to end results. If empty, this is the end of the day from the start date/time or ignored if the  'finished start date' isn't set" expr="" />
      <input type="datetime" name="Loaded Start Date" friendlyname="Loaded Start Date" narrative="The item loaded (added to queue) date/time to start results. If empty, then the loaded start date is ignored" expr="[DATE]" />
      <input type="datetime" name="Loaded End Date" friendlyname="Loaded End Date" narrative="The item loaded (added to queue) date/time to end results. If empty, this is the end of the day from the loaded start date/time. If that is also empty, then this parameter is ignored" expr="" />
      <input type="text" name="Resource Names" friendlyname="Resource Names" narrative="The semi-colon-separated names of the resources which worked the item. If empty, this will retrieve for all resources" expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a tag mask to filter by. This can consist of any number of tag searches - each term can be separated by a semi-colon and they are all applied to the search (ie. they are AND'ed terms not OR'ed terms). For example, &quot;Account: Joint; -Balance: Overdrawn; Card: *Visa*&quot; will include any items which match all the terms, ie. every item must have an 'Account: Joint' tag applied, no item can have a 'Balance: Overdrawn' tag applied, every item must have a tag applied which starts with 'Card: ' and then contains the text 'Visa'." expr="" />
      <input type="flag" name="Include unworked items?" friendlyname="Include unworked items?" narrative="Include any items which are currently pending - default is False" expr="False" />
      <input type="flag" name="Include deferred items?" friendlyname="Include deferred items?" narrative="Include any items which are currently deferred - default is False" expr="True" />
      <input type="flag" name="Include completed items?" friendlyname="Include completed items?" narrative="Include any items which are currently completed - default is False" expr="True" />
      <input type="flag" name="Include exception items?" friendlyname="Include exception items?" narrative="Include any items which are currently exceptioned - default is False" expr="True" />
      <input type="flag" name="Treat each attempt separately?" friendlyname="Treat each attempt separately?" narrative="Each time a queue item exceptions, a new linked 'retry' item is created with an incremented attempt number. By default, all attempts for an item will be treated as a single item for the purposes of the report. An argument of 'True' will indicate that each retry should be treated as a separate item." expr="" />
    </inputs>
    <outputs>
      <output type="number" name="Item Count" friendlyname="Item Count" narrative="The total number of queue items matched with the given parameters" stage="Item Count" />
      <output type="timespan" name="Time Total" friendlyname="Time Total" narrative="The total amount of time spent working with the matched queue items" stage="" />
      <output type="timespan" name="Least Time" friendlyname="Least Time" narrative="The least amount of time spent working on a single matched queue item" stage="" />
      <output type="timespan" name="Most Time" friendlyname="Most Time" narrative="The most amount of time spent working on a single matched queue item" stage="" />
      <output type="timespan" name="Median Time" friendlyname="Median Time" narrative="The median amount of time spent by the matched queue items" stage="" />
      <output type="timespan" name="Mean Time" friendlyname="Mean Time" narrative="The mean amount of time spent by each matched queue item" stage="" />
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs of all work queue items matched by the search. Note that all attempts of the same item have the same Item ID, and each attempt's ID will appear in this collection at most once, regardless of the 'Treat each attempt separately?' parameter" stage="Item IDs" />
    </outputs>
    <onsuccess>b4a73eba-8496-4bf8-a700-ed4b76538099</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Report Data" />
  </stage>
  <stage stageid="0a3b70b4-d201-497a-af2f-89fe792d2a4a" name="DATE" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-345" y="-90" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bbb6e8a8-3777-426b-9ab3-5448621ca83b" name="Output Data" type="Collection">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="255" y="-270" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item Key" type="text" />
      <field name="Work Time" type="text" />
      <field name="Status" type="text" />
      <field name="Exception Reason" type="text" />
    </collectioninfo>
  </stage>
  <stage stageid="3010b5e0-2b3d-4c9a-9ced-6c9099f14dc5" name="Setting to Final Output Data" type="MultipleCalculation">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-45" w="90" h="60" />
    <onsuccess>2f8bb03f-08d9-4d64-9d47-71b687bae760</onsuccess>
    <steps>
      <calculation expression="[Key]" stage="Output Data.Item Key" />
      <calculation expression="[New Work Time]" stage="Output Data.Work Time" />
    </steps>
  </stage>
  <stage stageid="26df2cae-6885-444e-9c94-6aa6da1d4c4c" name="Collections::Add Row" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-135" w="90" h="60" />
    <inputs>
      <input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Output Data&quot;" />
    </inputs>
    <onsuccess>3010b5e0-2b3d-4c9a-9ced-6c9099f14dc5</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="a4378505-4938-468b-852f-6aa3d478bed9" name="MS Excel VBO::Create Instance" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="240" y="-45" w="90" h="60" />
    <inputs>
      <input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="" />
    </inputs>
    <outputs>
      <output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" />
    </outputs>
    <onsuccess>a2c20bb1-ee94-43c3-80c6-61c22ffe4138</onsuccess>
    <resource object="MS Excel VBO" action="Create Instance" />
  </stage>
  <stage stageid="0ee947b1-45f3-4d9f-b486-aa3157d5013b" name="handle" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-420" y="-135" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a2c20bb1-ee94-43c3-80c6-61c22ffe4138" name="MS Excel VBO::Create Workbook" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="-45" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook should be created. The default of zero indicates the currently active instance." expr="[handle]" />
    </inputs>
    <outputs>
      <output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook that Excel has created - this can be changed using the &quot;Save Workbook As&quot; action" stage="Workbook Name" />
    </outputs>
    <onsuccess>d2e9145c-7ec6-432a-a070-73c164e9addc</onsuccess>
    <resource object="MS Excel VBO" action="Create Workbook" />
  </stage>
  <stage stageid="ec0634ba-b769-4816-ae58-e566c424399a" name="Workbook Name" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-345" y="-135" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="92f1c96b-c20c-4e5c-89ff-4d73f9673d32" name="MS Excel VBO::Write Collection" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="645" y="-45" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the specified collection should be written. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="collection" name="Collection" friendlyname="Collection" narrative="The collection containing the data which should be written to the worksheet." expr="[Output Data]" />
      <input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook within which the data should be written. The default empty value indicates the current workbook within the specified instance." expr="[Workbook Name]" />
      <input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the worksheet on which the given data should be written. The default empty value indicates the current sheet within the specified workbook." expr="&quot;Sheet1&quot;" />
      <input type="text" name="Cell Reference" friendlyname="Cell Reference" narrative="The reference at which the collection should be written." expr="&quot;A1&quot;" />
      <input type="flag" name="Include Column Names" friendlyname="Include Column Names" narrative="True to indicate that the column names from the collection should be written out as the first row; False to ignore the column names and just write out the data." expr="True" />
    </inputs>
    <onsuccess>f4bfadea-32a0-41dc-b391-59589fb4e0d9</onsuccess>
    <resource object="MS Excel VBO" action="Write Collection" />
  </stage>
  <stage stageid="f4bfadea-32a0-41dc-b391-59589fb4e0d9" name="MS Excel VBO::Save Workbook As" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="645" y="75" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the workbook which should be saved resides. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook which should be saved" expr="[Workbook Name]" />
      <input type="text" name="Filename" friendlyname="Filename" narrative="The full path and filename to which the workbook should be saved." expr="[Excel Path]" />
    </inputs>
    <outputs>
      <output type="text" name="New Workbook Name" friendlyname="New Workbook Name" narrative="The new workbook name which Excel will use to identify the workbook within the instance." stage="New Workbook Name" />
    </outputs>
    <onsuccess>49b19952-9281-4e5c-bb51-59a97d6868d6</onsuccess>
    <resource object="MS Excel VBO" action="Save Workbook As" />
  </stage>
  <stage stageid="e5c256b8-ce99-4c86-9c33-c9c1fed4199d" name="New Workbook Name" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-420" y="-90" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="678af3a4-b5a8-4f1f-9a1a-316536a4dba7" name="End5" type="End">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="375" y="75" w="90" h="60" />
    <outputs>
      <output type="text" name="Excel Path" stage="Excel Path" />
      <output type="number" name="Item Count" stage="Item Count" />
    </outputs>
  </stage>
  <stage stageid="d2e9145c-7ec6-432a-a070-73c164e9addc" name="MS Excel VBO::Create Worksheet" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="450" y="-45" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the worksheet should be created. The default of zero indicates the currently active instance." expr="[handle]" />
      <input type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name of the workbook in which the sheet should be created - The default empty value indicates the currently active workbook on the specified instance." expr="[Workbook Name]" />
      <input type="text" name="Worksheet Name" friendlyname="Worksheet Name" narrative="The name of the sheet which should be activated. The default empty text value indicates that the currently active sheet should be, er, activated, making this a no-op." expr="&quot;Sheet1&quot;" />
    </inputs>
    <onsuccess>e464d9fb-8d35-4c98-a1e8-02f0b56aeebf</onsuccess>
    <resource object="MS Excel VBO" action="Create Worksheet" />
  </stage>
  <stage stageid="49b19952-9281-4e5c-bb51-59a97d6868d6" name="MS Excel VBO::Close Instance" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="510" y="75" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance to be closed. Zero indicates the currently active instance." expr="[handle]" />
      <input type="flag" name="Save Changes" friendlyname="Save Changes" narrative="True to save the changes to the open workbooks on the instance, False to discard any changes. Default is False." expr="True" />
    </inputs>
    <onsuccess>678af3a4-b5a8-4f1f-9a1a-316536a4dba7</onsuccess>
    <resource object="MS Excel VBO" action="Close Instance" />
  </stage>
  <stage stageid="e464d9fb-8d35-4c98-a1e8-02f0b56aeebf" name="MS Excel VBO::Show" type="Action">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="540" y="-45" w="90" h="60" />
    <inputs>
      <input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance which should have its window displayed. The default of zero indicates the currently active instance." expr="[handle]" />
    </inputs>
    <onsuccess>92f1c96b-c20c-4e5c-89ff-4d73f9673d32</onsuccess>
    <resource object="MS Excel VBO" action="Show" />
  </stage>
  <stage stageid="81bfa4dd-6979-4ac4-8265-17b68f444d00" name="Key" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="330" y="-315" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="55cd704e-c35a-4613-a9d1-a3aeeb664030" name="New Work Time" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="330" y="-270" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b4b0ff02-76c7-44df-b72c-d1485dc3ee6a" name="Assigning Work Time to Text Data item" type="Calculation">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-195" />
    <onsuccess>26df2cae-6885-444e-9c94-6aa6da1d4c4c</onsuccess>
    <calculation expression="[Worktime]" stage="New Work Time" />
  </stage>
  <stage stageid="e3cbb205-3d68-4fef-8ead-4dec5b59eb8a" name="Set Excel Path and Local Time" type="MultipleCalculation">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-480" w="90" h="60" />
    <onsuccess>06e42663-e417-47d0-afbd-10165a7fe91f</onsuccess>
    <steps>
      <calculation expression="[File Path]&amp;&quot;\&quot;&amp;&quot;Output&quot;&amp;FormatDateTime(Now(), &quot;ddMMyy_hhmm_ss&quot;)&amp;&quot;.xlsx&quot;" stage="Excel Path" />
      <calculation expression="Today()" stage="DATE" />
    </steps>
  </stage>
  <stage stageid="82d50f84-c010-43aa-a87f-9397c45131f3" name="File Path" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-360" y="-45" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\BP_files\GSO</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5606d72c-f8fb-4fc0-837d-135f51758d0e" name="Excel Path" type="Data">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <display x="-420" y="-45" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="8516005c-b982-4cc8-ac23-aa6111e09a9c" name="Member Variables" type="Block">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="210" y="-390" w="165" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d6406f0d-5ffe-44d3-8350-a79662dea8ab" name="Member Variables" type="Block">
    <subsheetid>72d613cd-4350-46a5-942e-7630c91dcf17</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-465" y="-210" w="180" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="586f1061-7870-46a2-a59a-a62a3fba36a7" name="Contruct and Send Email Complete" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="240" y="-90" w="90" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="[Exception Type]" />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="" />
    </inputs>
    <onsuccess>70c6fac5-108c-48c3-a834-06417ec52644</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>c10b0887-463e-428e-ba34-965b06fe4bdd</processid>
  </stage>
  <stage stageid="c08d4f52-fb29-476f-b0cd-135916847206" name="Get Workqueue Report" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="240" y="-165" w="90" h="60" />
    <outputs>
      <output type="text" name="Excel Path" friendlyname="Excel Path" stage="Excel Path" />
      <output type="number" name="Item Count" friendlyname="Item Count" stage="Item Count" />
    </outputs>
    <onsuccess>586f1061-7870-46a2-a59a-a62a3fba36a7</onsuccess>
    <processid>72d613cd-4350-46a5-942e-7630c91dcf17</processid>
  </stage>
  <stage stageid="272054aa-0d49-4ef5-afc5-0a48c175aa3d" name="Read Excel Block" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-285" y="-480" w="765" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="bca5d73f-43de-4c8b-ac7c-2b70d15f32aa" name="Main Recover" type="Recover">
    <display x="315" y="-360" w="120" h="60" />
    <onsuccess>b7880c60-5304-4feb-a581-ac3f11871e35</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="b7880c60-5304-4feb-a581-ac3f11871e35" name="Set Exceptions " type="MultipleCalculation">
    <display x="435" y="-360" w="90" h="60" />
    <onsuccess>effd8a1f-e2d4-4d73-a743-faebdf53c3b7</onsuccess>
    <steps>
      <calculation expression="ExceptionType()" stage="Exception Type" />
      <calculation expression="ExceptionDetail()" stage="Exception Message" />
    </steps>
  </stage>
  <stage stageid="effd8a1f-e2d4-4d73-a743-faebdf53c3b7" name="Main Resume" type="Resume">
    <loginhibit />
    <display x="570" y="-360" w="90" h="60" />
    <onsuccess>cd30cdd9-05a7-4ed4-986a-883cd73d2054</onsuccess>
  </stage>
  <stage stageid="79e265d7-7ffe-4faa-83f5-62c8aa4f45e2" name="Member Variable" type="Block">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-510" y="-60" w="150" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b2e6750f-d8f5-44e9-ac86-e94111a6e166" name="Populate Queue" type="SubSheetInfo">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-420" y="-570" w="150" h="90" />
  </stage>
  <stage stageid="bf16381f-be33-4edf-b25d-cfad8ba2fa75" name="Start" type="Start">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="0" y="-1005" w="120" h="60" />
    <onsuccess>a171ba27-c5e8-4105-ad87-49f41d5a08b1</onsuccess>
  </stage>
  <stage stageid="6938135c-2d61-46aa-8396-c0636ef9ffb7" name="End" type="End">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="1380" w="120" h="60" />
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="66cdc887-a5c9-4175-97d6-27bdb215817c" name="Email - Exchange Managed API::Configure" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-825" w="120" h="60" />
    <inputs>
      <input type="flag" name="UseWindowsCredentials" friendlyname="UseWindowsCredentials" narrative="Use Windows credentials of currently logged on user instead of providing separate credentials" expr="[Use Windows Credtinials]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to authenticate with Exchange " expr="[Username]" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to authenticate with Exchange " expr="[Password]" />
    </inputs>
    <onsuccess>89556521-cd1b-44e3-b122-b9838edf4201</onsuccess>
    <resource object="Email - Exchange Managed API" action="Configure" />
  </stage>
  <stage stageid="1030e6e6-5a88-44f2-8a3b-b0f68d911933" name="Email - Exchange Managed API::List Mails Within DateTimes" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="0" y="-645" w="120" h="60" />
    <inputs>
      <input type="text" name="Sub-Folder" friendlyname="Sub-Folder" narrative="Optional. The name of a sub-folder below the Inbox from which to get emails.  If not set the Inbox will be used." expr="[SubFolder Name]" />
      <input type="flag" name="Unread Only?" friendlyname="Unread Only?" narrative="If True than only get unread emails, otherwise get any" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="collection" name="IDs" friendlyname="IDs" stage="IDs" />
    </outputs>
    <onsuccess>9592ea59-d31a-48de-a584-47f272448ced</onsuccess>
    <resource object="Email - Exchange Managed API" action="List Mails Within DateTimes" />
  </stage>
  <stage stageid="e19f4f57-ea43-4579-9d4e-f933dbe4f066" name="IDs" type="Collection">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-360" y="-360" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="63ebdbcd-7ea6-4ef8-bd1e-ff9d12628969" name="ID Loop" type="LoopStart">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-135" w="120" h="60" />
    <onsuccess>6c85dd80-477b-4f25-9179-5d33ddba019b</onsuccess>
    <groupid>02ae72e8-9e7c-4b81-9bce-d37e56510a45</groupid>
    <looptype>ForEach</looptype>
    <loopdata>IDs</loopdata>
  </stage>
  <stage stageid="c5f2fef2-a5a6-4bef-b9f1-57d36ab55fbf" name="ID Loop" type="LoopEnd">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="1245" w="150" h="60" />
    <onsuccess>6938135c-2d61-46aa-8396-c0636ef9ffb7</onsuccess>
    <groupid>02ae72e8-9e7c-4b81-9bce-d37e56510a45</groupid>
  </stage>
  <stage stageid="172aaa98-f8a5-4a30-9cd2-ad692c831b59" name="Success" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-525" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e2d81825-a608-46a6-a0a0-3f24628d2c4b" name="Error Message" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="495" y="-525" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6c85dd80-477b-4f25-9179-5d33ddba019b" name="Email - Exchange Managed API::Get Mail using ID" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-45" w="120" h="60" />
    <inputs>
      <input type="text" name="Attachment Directory" friendlyname="Attachment Directory" expr="[Directory Path]" />
      <input type="text" name="Mail ID" friendlyname="Mail ID" expr="[IDs.ID]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="Sender Name" friendlyname="Sender Name" stage="Sender Name" />
      <output type="text" name="Sender Email Address" friendlyname="Sender Email Address" stage="Sender Email Address" />
      <output type="text" name="Subject" friendlyname="Subject" stage="Subject" />
      <output type="text" name="Message Body" friendlyname="Message Body" stage="Message Body" />
      <output type="text" name="Attachment Names" friendlyname="Attachment Names" stage="" />
      <output type="text" name="ID" friendlyname="ID" stage="ID" />
    </outputs>
    <onsuccess>422842fb-cb0b-4395-a4fd-11e20529dbf8</onsuccess>
    <resource object="Email - Exchange Managed API" action="Get Mail using ID" />
  </stage>
  <stage stageid="422842fb-cb0b-4395-a4fd-11e20529dbf8" name="Get Vendor Name" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="75" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Name of Third Party Supplier&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Project Code&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Vendor name" />
    </outputs>
    <onsuccess>b6dab558-de90-4363-b867-79647c851b2a</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="f7d8ad9a-3499-4db7-887c-045add1c6b92" name="Subject" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-480" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Automatic reply:GSO Approval</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="805571f7-1000-4eb0-917a-0ef16ab7b9a8" name="Message Body" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="480" y="-435" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7510feb3-8fe0-4805-b9c6-85d7c3cabeba" name="ID" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="480" y="-480" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e4dc67d4-9f27-4f09-b755-aa393e9b8840" name="Vendor name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-435" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4b6aeec6-1038-4988-9809-38b2220f01cc" name="Work Queues::Add To Queue" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibitparameters />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="-15" y="1050" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Work Queue Name]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Input Collection]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;Ready to Start checking for vendor name&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="Item IDs" />
    </outputs>
    <onsuccess>1fb88fc5-7b07-40be-bd5f-259a8fc11807</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="4072fbbb-029a-485d-b949-be028beca9a8" name="Item Key" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-390" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b39ba289-3d19-4ef3-8afb-385df63d9022" name="Item IDs" type="Collection">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="495" y="-390" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="6a4b2175-7ef8-4486-bc73-1e68cd3610d0" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="750" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="[SubFolder Completed Name]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>a06a4063-a21e-42fa-bf5d-e0be5a7df965</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="a06a4063-a21e-42fa-bf5d-e0be5a7df965" name="Setting the ID" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="750" w="120" h="60" />
    <onsuccess>ccc6f1e3-b126-40f3-8baa-c746f893ee6b</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="532be7bc-fb53-46c1-8c94-38fd23ec2752" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="675" w="120" h="60" />
    <onsuccess>6a4b2175-7ef8-4486-bc73-1e68cd3610d0</onsuccess>
    <steps>
      <calculation expression="Trim(Lower([Vendor name]))" stage="Input Collection.Vendor Name" />
      <calculation expression="Trim([Project code])" stage="Input Collection.Project Code" />
      <calculation expression="Trim([Subject])&amp;&quot;_&quot;&amp;Trim([Project code])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="fd0d4285-ca99-403e-a6b3-9b3d3f2fc09c" name="Anchor2" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="1245" w="10" h="10" />
    <onsuccess>c5f2fef2-a5a6-4bef-b9f1-57d36ab55fbf</onsuccess>
  </stage>
  <stage stageid="9592ea59-d31a-48de-a584-47f272448ced" name="Checks the mail" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="0" y="-555" w="120" h="60" />
    <decision expression="InStr([Error Message], &quot;No mails found in the folder&quot;)&gt;0" />
    <ontrue>f5dd15e0-18d5-4845-8c8a-4f539fb49c4d</ontrue>
    <onfalse>3c7d61ce-4a74-4da2-a030-0cf733e1c7b8</onfalse>
  </stage>
  <stage stageid="f5dd15e0-18d5-4845-8c8a-4f539fb49c4d" name="End3" type="End">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="-555" w="90" h="60" />
  </stage>
  <stage stageid="c59958fc-bc68-4fb8-907e-e09834a8fbd0" name="SubFolder Name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-345" y="-405" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">inbox</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3f7eea02-13c6-4d23-afbe-e33b4bc9714c" name="Directory Path" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-435" y="-405" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\BP_files\GSO\Attachments</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="8e1056fb-88f2-41cf-9b52-f04a8b108e6c" name="SubFolder Completed Name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-450" y="-360" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Completed</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8f019dee-4a21-4522-a103-396943bd4334" name="Member Variables" type="Block">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-510" y="-495" w="240" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="344764d9-f8dc-4aaf-aea1-e893296a25e4" name="Member Variables" type="Block">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="-555" w="210" h="285" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9459eb87-fc3b-4f27-858d-fd7fbc4e4301" name="Work Queue Name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-345" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Email Classification</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="dd6ef898-975b-4d5b-a926-fedd27d1e887" name="New Mail Id" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="480" y="-345" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="38a9e491-0c3f-4997-b4ce-6f6007b55131" name="Get Project Code" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="285" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Project Code&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Direct or Indirect /&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Project code" />
    </outputs>
    <onsuccess>1fda6a3f-0c23-4960-a9d4-a2fb414d6b6f</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="ed1a2634-d160-47a0-937a-36540936db8d" name="Project code" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="-300" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3c7d61ce-4a74-4da2-a030-0cf733e1c7b8" name="Check Directory?" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="0" y="-480" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Name" narrative="The directory to check exists" expr="[Directory Path]" />
    </inputs>
    <outputs>
      <output type="flag" name="Exists" narrative="True if the directory exists" stage="Directory Exists" />
    </outputs>
    <onsuccess>ffbf005c-46be-41e8-a9a3-d0428535f123</onsuccess>
    <resource object="Utility - File Management" action="Directory Exists" />
  </stage>
  <stage stageid="ffbf005c-46be-41e8-a9a3-d0428535f123" name="If Directory Exist? " type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="0" y="-405" w="90" h="60" />
    <decision expression="[Directory Exists]" />
    <ontrue>8bf3b9b7-b9c9-44d9-8a22-6b33f08db146</ontrue>
    <onfalse>835b9593-45ec-4e11-aefd-4b8c9d68a40c</onfalse>
  </stage>
  <stage stageid="8bf3b9b7-b9c9-44d9-8a22-6b33f08db146" name="Delete Directory Files" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="150" y="-405" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Path" narrative="The path of the directory to delete" expr="[Directory Path]" />
      <input type="flag" name="Error If Not Exists" narrative="Set True to raise an error if the path does not exist" expr="" />
      <input type="flag" name="Recursive" narrative="Set True to delete all sub-directories of the path aswell" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Error Message" />
    </outputs>
    <onsuccess>3aceeeaf-eb0a-45cc-b5e5-6afbae173d4d</onsuccess>
    <resource object="Utility - File Management" action="Delete Directory" />
  </stage>
  <stage stageid="3aceeeaf-eb0a-45cc-b5e5-6afbae173d4d" name="Create Directory" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="150" y="-315" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Path" narrative="The path in which to create the directory" expr="[Directory Path]" />
      <input type="flag" name="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Error Message" />
    </outputs>
    <onsuccess>74f552d4-9dbb-4b46-ba73-92d01ee82d54</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="b76c24d1-cbf7-4c43-8d27-bae68f086098" name="Sleep" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="-225" w="120" h="60" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="1" />
    </inputs>
    <onsuccess>63ebdbcd-7ea6-4ef8-bd1e-ff9d12628969</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="835b9593-45ec-4e11-aefd-4b8c9d68a40c" name="Anchor6" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-315" w="10" h="10" />
    <onsuccess>3aceeeaf-eb0a-45cc-b5e5-6afbae173d4d</onsuccess>
  </stage>
  <stage stageid="74f552d4-9dbb-4b46-ba73-92d01ee82d54" name="Anchor1" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-225" w="10" h="10" />
    <onsuccess>b76c24d1-cbf7-4c43-8d27-bae68f086098</onsuccess>
  </stage>
  <stage stageid="3ecc588a-1db1-4a3f-a583-7fe1b39b49c2" name="Directory Exists" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="480" y="-300" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="508861ac-55ac-45bb-9645-7d739f25d90a" name="Check Vendor Name 911 Secure?" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="570" y="75" w="90" h="60" />
    <decision expression="[Vendor name]=&quot;911 Secure&quot;" />
    <ontrue>dde2ece8-9d6e-4e11-b769-3a851f4a1085</ontrue>
    <onfalse>97a09af5-179c-49e1-a6a8-b81adf195d4e</onfalse>
  </stage>
  <stage stageid="dde2ece8-9d6e-4e11-b769-3a851f4a1085" name="Set to 911 Secure LLC" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="75" />
    <onsuccess>22d2288f-0ed3-4d16-b3f1-39f3b0368dd9</onsuccess>
    <calculation expression="&quot;911 SECURE LLC&quot;" stage="Vendor name" />
  </stage>
  <stage stageid="22d2288f-0ed3-4d16-b3f1-39f3b0368dd9" name="Anchor13" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="210" w="10" h="10" />
    <onsuccess>97a09af5-179c-49e1-a6a8-b81adf195d4e</onsuccess>
  </stage>
  <stage stageid="b6dab558-de90-4363-b867-79647c851b2a" name="Check Vendor Name Exists?" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="75" w="90" h="60" />
    <decision expression="[Vendor name]=&quot;&quot;" />
    <ontrue>3898d6a9-a27d-42ac-818b-6b53aa56b415</ontrue>
    <onfalse>508861ac-55ac-45bb-9645-7d739f25d90a</onfalse>
  </stage>
  <stage stageid="6bf3e9a7-19d6-4ae0-aea9-634de73716df" name="Anchor3" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="210" w="10" h="10" />
    <onsuccess>e5f4d7bf-5bdc-4e95-8fa9-23f1f1938830</onsuccess>
  </stage>
  <stage stageid="3898d6a9-a27d-42ac-818b-6b53aa56b415" name="Vendor Name not found" type="Exception">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="405" y="30" w="90" h="30" />
    <exception localized="yes" type="Business Exception" detail="&quot;Third Party Supplier Name doesn't exits in the mail&quot;" />
  </stage>
  <stage stageid="97a09af5-179c-49e1-a6a8-b81adf195d4e" name="Anchor14" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="570" y="210" w="10" h="10" />
    <onsuccess>6bf3e9a7-19d6-4ae0-aea9-634de73716df</onsuccess>
  </stage>
  <stage stageid="fd65531f-3860-4275-a75f-b31a926ae48e" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="-15" y="870" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>517fd880-1eef-4f90-bd39-93445176b76a</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="cb44f0bb-f9a5-4bf0-9f22-e587aae8f9c2" name="Item in Queue" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-405" y="165" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="61bf1ebe-eb3b-455e-ba4a-154d0ec63752" name="Item ID New" type="Collection">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-330" y="105" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="ccc6f1e3-b126-40f3-8baa-c746f893ee6b" name="Anchor16" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="870" w="10" h="10" />
    <onsuccess>fd65531f-3860-4275-a75f-b31a926ae48e</onsuccess>
  </stage>
  <stage stageid="517fd880-1eef-4f90-bd39-93445176b76a" name="Check Item In Queue" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="945" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>bcbe9342-4f02-4058-8e02-cebe2745414d</ontrue>
    <onfalse>4b6aeec6-1038-4988-9809-38b2220f01cc</onfalse>
  </stage>
  <stage stageid="6d11e2ea-0636-403b-ba1d-8f8a54ed78aa" name="Get Third Party Supplier Block" type="Block">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-135" y="0" w="855" h="225" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="d531172c-8fa4-4d63-8da8-58c891431892" name="Recover" type="Recover">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="150" y="165" w="120" h="60" />
    <onsuccess>664d76fc-0834-49b6-810f-f90123a8aef7</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="51745aa1-45b9-4c21-8438-61253cc4ef12" name="Resume" type="Resume">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="390" y="165" w="90" h="60" />
    <onsuccess>3dcfa98b-3b80-4e2f-a33b-755171d26d55</onsuccess>
  </stage>
  <stage stageid="664d76fc-0834-49b6-810f-f90123a8aef7" name="Set to Exception Detail" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="270" y="165" />
    <onsuccess>51745aa1-45b9-4c21-8438-61253cc4ef12</onsuccess>
    <calculation expression="ExceptionDetail()&amp;&quot;;&quot;&amp;&quot;Can't able to get third party supplier in the email&quot;" stage="Exception Message" />
  </stage>
  <stage stageid="d669200e-fbf5-4ff7-bffd-799dce40dc01" name="Exception Message" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-345" y="165" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cd30cdd9-05a7-4ed4-986a-883cd73d2054" name="Contruct and Send Exception  Email" type="SubSheet">
    <display x="570" y="-435" w="90" h="30" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="[Exception Type]" />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="" />
    </inputs>
    <onsuccess>7a3d5f30-5eef-444a-904c-85707447e986</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>c10b0887-463e-428e-ba34-965b06fe4bdd</processid>
  </stage>
  <stage stageid="c327d5ee-a341-43bc-96fb-97883cc5cdb4" name="SubFolder Exception Name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-435" y="-450" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Exception</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a171ba27-c5e8-4105-ad87-49f41d5a08b1" name="Credentials::Get" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="0" y="-915" w="120" h="60" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GSO Mailbox&quot;" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>66cdc887-a5c9-4175-97d6-27bdb215817c</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="eb1b8b90-374c-46b4-8a31-361954f09c24" name="Credentials::Get" type="Action">
    <subsheetid>270d450b-e968-4a72-929d-803d10468bcd</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="120" y="0" w="120" h="60" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GSO Mailbox&quot;" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>70d494c4-2d43-45eb-a818-f7f59f125d5e</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="b7643550-2a30-4fd5-a95e-828c4154fe05" name="Utility - General::Sleep" type="Action">
    <loginhibit onsuccess="true" />
    <display x="0" y="-780" w="120" h="60" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="5" />
    </inputs>
    <onsuccess>28500c2a-6a2c-4225-a630-8c393d6403fa</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="a37b7da8-a9ff-432b-b2a8-4d7ae125d636" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="1170" w="90" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Completed&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>8d7dfc69-5656-4da6-b025-f4ab5f56c53f</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="8d7dfc69-5656-4da6-b025-f4ab5f56c53f" name="Setting the ID" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="390" y="1245" w="120" h="60" />
    <onsuccess>fd0d4285-ca99-403e-a6b3-9b3d3f2fc09c</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="2e751b47-13ef-4b41-92c2-55e7a82add5c" name="Sender Name" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-390" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="a3f5fd9c-33a0-4444-be22-f954a5e02f22" name="Subject Flag" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-390" y="210" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="00f60704-6f96-4d96-99d7-804fb7490b21" name="Anchor19" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="420" w="10" h="10" />
    <onsuccess>8ea3f78d-d4d4-41f6-b8e1-3cd6bcb8fa50</onsuccess>
  </stage>
  <stage stageid="c8a6cf4e-15cd-4fa2-bac4-67181d67a40f" name="Resellers Collection" type="Collection">
    <display x="-555" y="-615" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b382dbe5-43a6-434f-b229-54aed0fcd885" name="OEM  Collection" type="Collection">
    <display x="-465" y="-615" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1fda6a3f-0c23-4960-a9d4-a2fb414d6b6f" name="Choice1" type="ChoiceStart">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="390" />
    <groupid>b5d09f99-04c5-4937-8140-da8ec39188d7</groupid>
    <choices>
      <choice expression="StartsWith(Trim([Subject]),&quot;RE:&quot;) OR StartsWith(Trim([Subject]),&quot;Re:&quot;)">
        <name>RE</name>
        <distance>30</distance>
        <ontrue>10f1962e-ca29-4517-84ae-199ef68f9316</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;FW:&quot;) OR StartsWith(Trim([Subject]),&quot;Fw:&quot;)">
        <name>FW</name>
        <distance>75</distance>
        <ontrue>96976499-df29-4d0b-91ee-b95bf6574711</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;Automatic reply:&quot;) OR StartsWith(Trim([Subject]),&quot;AUTOMATIC REPLY:&quot;)">
        <name>Automatic Reply</name>
        <distance>120</distance>
        <ontrue>7f67410d-f997-4cbd-a9c6-24e2b96316e5</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="a7729286-a13d-473d-89d8-0ed1f9d61f78" name="Otherwise1" type="ChoiceEnd">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="555" />
    <onsuccess>38e88945-e84b-43f5-be7a-7e1f620ad10f</onsuccess>
    <groupid>b5d09f99-04c5-4937-8140-da8ec39188d7</groupid>
  </stage>
  <stage stageid="8ea3f78d-d4d4-41f6-b8e1-3cd6bcb8fa50" name="Anchor18" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="465" w="10" h="10" />
    <onsuccess>ed0591fc-2186-4213-b46e-0dc56e8fb09c</onsuccess>
  </stage>
  <stage stageid="ed0591fc-2186-4213-b46e-0dc56e8fb09c" name="Anchor23" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="510" w="10" h="10" />
    <onsuccess>ea6f1704-60cc-4b99-a5c3-dd5f68f22782</onsuccess>
  </stage>
  <stage stageid="8a90440e-9e76-41b8-a2c6-485588259ee7" name="Sender Email Address" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-270" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="88279ec7-8fa7-4c4d-8a90-1d3064b988e8" name="Work Queues::Add To Queue" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="525" y="855" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Work Queue Name]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Input Collection]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;Ready to Start checking for vendor name&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="Item IDs" />
    </outputs>
    <onsuccess>b71f0147-0959-44f7-982f-ffddeac7cf19</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="ff68d02a-e57f-4c47-88d1-800d9e39411e" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="390" y="765" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>bdbf287c-819b-41f8-b6af-a62ecf76de98</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="bdbf287c-819b-41f8-b6af-a62ecf76de98" name="Check Item In Queue" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="855" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>0dcf5e38-23fb-4613-bd9c-166d767a550f</ontrue>
    <onfalse>88279ec7-8fa7-4c4d-8a90-1d3064b988e8</onfalse>
  </stage>
  <stage stageid="0dcf5e38-23fb-4613-bd9c-166d767a550f" name="Anchor22" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="255" y="855" w="10" h="10" />
    <onsuccess>74cf48db-42e1-407b-9655-d51e078da50a</onsuccess>
  </stage>
  <stage stageid="74cf48db-42e1-407b-9655-d51e078da50a" name="Anchor25" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="255" y="1110" w="10" h="10" />
    <onsuccess>650f9825-b451-4bbc-a14a-b7c52f534b6b</onsuccess>
  </stage>
  <stage stageid="b71f0147-0959-44f7-982f-ffddeac7cf19" name="Anchor26" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="525" y="930" w="10" h="10" />
    <onsuccess>7218952d-f801-460e-8eeb-00c3a92802df</onsuccess>
  </stage>
  <stage stageid="1fa9d24f-a9d1-471f-a497-cb3e2363cd0c" name="New Item ID" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="810" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="36f66462-805d-49f4-8dfe-c39afe3f6a63" name="Work Queues::Mark Exception" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="810" y="1110" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item IDs.Item ID]" />
      <input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="&quot;Mail ID Grid not Valid&quot;" />
      <input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="" />
      <input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" />
    </outputs>
    <onsuccess>f5685610-3d59-4317-ac50-3e644a0e07cd</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="bcbe9342-4f02-4058-8e02-cebe2745414d" name="Anchor27" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="945" w="10" h="10" />
    <onsuccess>fd0d4285-ca99-403e-a6b3-9b3d3f2fc09c</onsuccess>
  </stage>
  <stage stageid="6432e931-b33e-48e4-8080-4bc011c17513" name="Work Queues::Untag Item" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <narrative>Removes a tag from a work queue item</narrative>
    <display x="390" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the queue item to remove the tag from" expr="[Item IDs.Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" narrative="The tag to remove from the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Ready to start checking for vendor name&quot;" />
    </inputs>
    <onsuccess>1ce5730e-eb55-4b9e-a149-1bc5de2f9a92</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Untag Item" />
  </stage>
  <stage stageid="11c97e59-6341-45c9-9388-5925eeb4c553" name="Work Queues::Get Item By ID" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="810" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Work Queue Name]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[Item ID New.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>36f66462-805d-49f4-8dfe-c39afe3f6a63</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="d2664113-2d07-4824-81c7-a46c8f4994cc" name="Check Item In Queue" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="675" y="1005" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>11c97e59-6341-45c9-9388-5925eeb4c553</ontrue>
    <onfalse>f5685610-3d59-4317-ac50-3e644a0e07cd</onfalse>
  </stage>
  <stage stageid="1ce5730e-eb55-4b9e-a149-1bc5de2f9a92" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="540" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>d2664113-2d07-4824-81c7-a46c8f4994cc</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="10f1962e-ca29-4517-84ae-199ef68f9316" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="420" />
    <onsuccess>00f60704-6f96-4d96-99d7-804fb7490b21</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;RE:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="96976499-df29-4d0b-91ee-b95bf6574711" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="465" />
    <onsuccess>8ea3f78d-d4d4-41f6-b8e1-3cd6bcb8fa50</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;FW:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="7f67410d-f997-4cbd-a9c6-24e2b96316e5" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="510" />
    <onsuccess>ed0591fc-2186-4213-b46e-0dc56e8fb09c</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;AUTOMATIC REPLY:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="5e4c96af-baf4-4562-8306-e61ae211f9fe" name="Anchor19" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="435" w="10" h="10" />
    <onsuccess>89ca90bb-f581-440d-be4f-608744787024</onsuccess>
  </stage>
  <stage stageid="4f3adfec-1f17-43c0-b15a-996e1870841c" name="Choice1" type="ChoiceStart">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="405" />
    <groupid>628d5aa8-8751-4a68-89b3-b4f263c621c3</groupid>
    <choices>
      <choice expression="StartsWith(Trim([Subject]),&quot;RE:&quot;) OR StartsWith(Trim([Subject]),&quot;Re:&quot;)">
        <name>RE</name>
        <distance>30</distance>
        <ontrue>a28da858-c4c1-40dd-8839-10b05cf16db7</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;FW:&quot;) OR StartsWith(Trim([Subject]),&quot;Fw:&quot;)">
        <name>FW</name>
        <distance>75</distance>
        <ontrue>036d4626-7332-41c4-a43a-d0f8f0fc27aa</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;Automatic reply:&quot;) OR StartsWith(Trim([Subject]),&quot;AUTOMATIC REPLY:&quot;)">
        <name>Automatic Reply</name>
        <distance>120</distance>
        <ontrue>12ed51d4-a2c1-402f-8282-91834b5f3285</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="f46792ff-f799-40c0-ad3b-f599bfea007e" name="Otherwise1" type="ChoiceEnd">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="570" />
    <onsuccess>eab76053-1bfe-4064-b3d0-0deaac81a7bb</onsuccess>
    <groupid>628d5aa8-8751-4a68-89b3-b4f263c621c3</groupid>
  </stage>
  <stage stageid="89ca90bb-f581-440d-be4f-608744787024" name="Anchor18" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="480" w="10" h="10" />
    <onsuccess>45ea4b99-8bd1-4e69-9b2c-9f340b73f430</onsuccess>
  </stage>
  <stage stageid="45ea4b99-8bd1-4e69-9b2c-9f340b73f430" name="Anchor23" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="525" w="10" h="10" />
    <onsuccess>2a0c1d9d-5f67-4ddb-a7c9-f2c8e3810dc1</onsuccess>
  </stage>
  <stage stageid="a28da858-c4c1-40dd-8839-10b05cf16db7" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="435" />
    <onsuccess>5e4c96af-baf4-4562-8306-e61ae211f9fe</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;RE:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="036d4626-7332-41c4-a43a-d0f8f0fc27aa" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="480" />
    <onsuccess>89ca90bb-f581-440d-be4f-608744787024</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;FW:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="12ed51d4-a2c1-402f-8282-91834b5f3285" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="525" />
    <onsuccess>45ea4b99-8bd1-4e69-9b2c-9f340b73f430</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;AUTOMATIC REPLY:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="e5f4d7bf-5bdc-4e95-8fa9-23f1f1938830" name="Anchor39" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="210" w="10" h="10" />
    <onsuccess>38a9e491-0c3f-4997-b4ce-6f6007b55131</onsuccess>
  </stage>
  <stage stageid="f5685610-3d59-4317-ac50-3e644a0e07cd" name="Anchor17" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="675" y="1110" w="10" h="10" />
    <onsuccess>650f9825-b451-4bbc-a14a-b7c52f534b6b</onsuccess>
  </stage>
  <stage stageid="a2720bcc-9cb2-4608-881f-be3dae5508f6" name="Block1" type="Block">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="810" w="1245" h="480" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5e4b7727-ad3d-4d7c-9c6d-2f823b1cf39a" name="Recover2" type="Recover">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="945" y="1215" w="120" h="60" />
    <onsuccess>2cad7546-fef8-4499-ba4c-72c308615daf</onsuccess>
  </stage>
  <stage stageid="2cad7546-fef8-4499-ba4c-72c308615daf" name="Resume2" type="Resume">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="945" y="1395" w="120" h="60" />
    <onsuccess>f761249d-d6e7-4bb7-a4dd-8d777c992d4f</onsuccess>
  </stage>
  <stage stageid="83f768a6-2401-4f42-8b67-3cb4da8e039b" name="Anchor40" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="1395" w="10" h="10" />
    <onsuccess>fd0d4285-ca99-403e-a6b3-9b3d3f2fc09c</onsuccess>
  </stage>
  <stage stageid="f761249d-d6e7-4bb7-a4dd-8d777c992d4f" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="750" y="1395" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Exception&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>97f6d651-7c26-49ef-aaf6-f222745c097b</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="97f6d651-7c26-49ef-aaf6-f222745c097b" name="Setting the ID" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="540" y="1395" w="120" h="60" />
    <onsuccess>83f768a6-2401-4f42-8b67-3cb4da8e039b</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="7a3d5f30-5eef-444a-904c-85707447e986" name="End2" type="End">
    <loginhibit onsuccess="true" />
    <display x="705" y="-435" w="90" h="60" />
  </stage>
  <stage stageid="4e921d12-082e-4705-849e-d1a3f953adbe" name="Cannot able to get Excel datas" type="Exception">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="390" y="150" w="180" h="60" />
    <exception localized="yes" type="System Exception" detail="ExceptionDetail()" />
  </stage>
  <stage stageid="a0d416fd-f1f3-47c8-a7e3-e8cf4590cc22" name="MS Excel VBO::Close All Instances" type="Action">
    <subsheetid>4b4b2c48-009a-4411-8d3e-96b41ddde853</subsheetid>
    <display x="165" y="150" w="90" h="60" />
    <onsuccess>4e921d12-082e-4705-849e-d1a3f953adbe</onsuccess>
    <resource object="MS Excel VBO" action="Close All Instances" />
  </stage>
  <stage stageid="f6879b1b-b1e5-43fa-8305-735f8f44d9bc" name="Local Date Time" type="Data">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-405" y="270" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5068c5de-4a64-4bb3-9fb1-9f3a97ce27f2" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="675" w="90" h="60" />
    <onsuccess>ff68d02a-e57f-4c47-88d1-800d9e39411e</onsuccess>
    <steps>
      <calculation expression="Today()&amp;&quot;_&quot;&amp;LocalTime()" stage="Local Date Time" />
      <calculation expression="Trim([Subject])&amp;&quot;_&quot;&amp;[Local Date Time]" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="38e88945-e84b-43f5-be7a-7e1f620ad10f" name="Check GSO ?" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-15" y="615" />
    <decision expression="Trim([Subject])=&quot;GSO 3rd Party Approval&quot;" />
    <ontrue>532be7bc-fb53-46c1-8c94-38fd23ec2752</ontrue>
    <onfalse>8f498a9a-5787-451c-94ab-2bef0a083013</onfalse>
  </stage>
  <stage stageid="ea6f1704-60cc-4b99-a5c3-dd5f68f22782" name="Anchor28" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="615" w="10" h="10" />
    <onsuccess>38e88945-e84b-43f5-be7a-7e1f620ad10f</onsuccess>
  </stage>
  <stage stageid="3e55d156-f8a6-4631-b36a-90c2ffb9ab21" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-195" y="750" w="120" h="60" />
    <onsuccess>6a4b2175-7ef8-4486-bc73-1e68cd3610d0</onsuccess>
    <steps>
      <calculation expression="Trim(Lower([Vendor name]))" stage="Input Collection.Vendor Name" />
      <calculation expression="Trim([Project code])" stage="Input Collection.Project Code" />
      <calculation expression="Trim([Subject])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="eab76053-1bfe-4064-b3d0-0deaac81a7bb" name="Check GSO ?" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="615" />
    <decision expression="Trim([Subject])=&quot;GSO 3rd Party Approval&quot;" />
    <ontrue>5068c5de-4a64-4bb3-9fb1-9f3a97ce27f2</ontrue>
    <onfalse>1395239a-5056-4837-941d-d95e7b948ec0</onfalse>
  </stage>
  <stage stageid="2a0c1d9d-5f67-4ddb-a7c9-f2c8e3810dc1" name="Anchor20" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="615" w="10" h="10" />
    <onsuccess>eab76053-1bfe-4064-b3d0-0deaac81a7bb</onsuccess>
  </stage>
  <stage stageid="9db67430-4fa2-4d78-a0eb-202bf3324ef1" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="270" y="765" w="90" h="60" />
    <onsuccess>ff68d02a-e57f-4c47-88d1-800d9e39411e</onsuccess>
    <steps>
      <calculation expression="Trim([Subject])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="a1228453-e4ba-4c3b-bf10-5118f26e2247" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-315" y="1095" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Completed&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>b1083ac6-503e-44ba-b622-5e434d1674da</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="b1083ac6-503e-44ba-b622-5e434d1674da" name="Setting the ID" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="1245" w="120" h="60" />
    <onsuccess>c5f2fef2-a5a6-4bef-b9f1-57d36ab55fbf</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="e5e3bc5f-6fbf-46ac-b03f-4f112d2c4b49" name="Assigning Vendor Name and Project Code" type="MultipleCalculation">
    <display x="0" y="-15" w="90" h="60" />
    <onsuccess>c420e15b-d146-4d22-95f8-4670095a2f73</onsuccess>
    <steps>
      <calculation expression="Trim(Lower([Data.Vendor Name]))" stage="Vendor Name" />
      <calculation expression="Trim(Upper([Data.Project Code]))" stage="Project Code" />
    </steps>
  </stage>
  <stage stageid="eee486f7-7ac6-4d34-af7c-7f38df918274" name="Project Code" type="Data">
    <display x="-495" y="-435" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="26a5e31c-c4a5-4e82-b9d2-884bf17ae8e8" name="Checking the Vendor name in the excel and Forwarding the mail" type="SubSheetInfo">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-330" y="-855" w="150" h="90" />
  </stage>
  <stage stageid="f4dc011a-be84-4a82-ad8f-d9df6fe23d01" name="Start" type="Start">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="75" y="-1005" w="120" h="60" />
    <inputs>
      <input type="collection" name="Resellers Collection" stage="Resellers Collection" />
      <input type="collection" name="OEM  Collection" stage="OEM  Collection" />
    </inputs>
    <onsuccess>06204cfe-377c-4dcf-b11f-a2e208b9b816</onsuccess>
  </stage>
  <stage stageid="925db721-2778-4677-a88f-68997b19240f" name="Mail ID" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-360" y="-555" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
  </stage>
  <stage stageid="9b6fe74e-0c74-46d3-8f2b-213b80f1b23f" name="Success" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-285" y="-510" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="14700041-05cb-4858-a05b-e9b991b86d42" name="Error Message" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-360" y="-510" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="15feaaf1-20f6-4e07-8339-8218dcd09eae" name="Member Variables" type="Block">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-405" y="-585" w="165" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="02659d44-58d7-4f8b-90ef-4591c8256383" name="End" type="End">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="105" w="90" h="60" />
    <outputs>
      <output type="text" name="Result Value" stage="Result Value" />
    </outputs>
  </stage>
  <stage stageid="36f2f0cf-de4f-4370-a241-331e43450d5a" name="Result Value" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-330" y="-465" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cb42f4d8-7545-4b69-bf6a-1a7f6e55762f" name="Setting the Result-Mail Forward" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="15" w="90" h="60" />
    <onsuccess>02659d44-58d7-4f8b-90ef-4591c8256383</onsuccess>
    <calculation expression="&quot;Mail Forwarding Done&quot;" stage="Result Value" />
  </stage>
  <stage stageid="95570a82-74af-4469-90bb-766d5d27ed44" name="Check Success" type="Decision">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-75" w="90" h="30" />
    <decision expression="[Success]=True" />
    <ontrue>cb42f4d8-7545-4b69-bf6a-1a7f6e55762f</ontrue>
    <onfalse>bd37dca6-432b-42e4-b776-e1c708a723a7</onfalse>
  </stage>
  <stage stageid="bd37dca6-432b-42e4-b776-e1c708a723a7" name="Forward Mail Failed" type="Exception">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="345" y="-75" w="120" h="30" />
    <exception localized="yes" type="System Exception" detail="&quot;Forward Mail Failed&quot;" />
  </stage>
  <stage stageid="84e63a84-00ff-4dbf-916d-5a7eae589904" name="Checking the vendor name and forwarding the mail" type="Block">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-165" y="-960" w="660" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4ce62272-6b1c-4dde-8e1c-902138294f91" name="Email - Exchange Managed API::Forward Mail using ID " type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-210" w="120" h="60" />
    <inputs>
      <input type="text" name="Mail ID" friendlyname="Mail ID" expr="[Data.New Item ID]" />
      <input type="text" name="To" friendlyname="To" expr="[Mail ID]" />
      <input type="text" name="CC" friendlyname="CC" expr="[Forward CC MailID]" />
    </inputs>
    <outputs>
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
    </outputs>
    <onsuccess>c0e9dc0c-5a71-4c79-bd9c-cb530f4b570e</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <resource object="Email - Exchange Managed API" action="Forward Mail using ID " />
  </stage>
  <stage stageid="c0e9dc0c-5a71-4c79-bd9c-cb530f4b570e" name="Sleep" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-135" w="120" h="60" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="3" />
    </inputs>
    <onsuccess>95570a82-74af-4469-90bb-766d5d27ed44</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="8098e553-ea3c-4ffd-8d57-852c9de577fa" name="Checks Mail ID Value?" type="Decision">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-540" w="90" h="30" />
    <decision expression="[Mail ID]&lt;&gt;&quot;&quot;" />
    <ontrue>c1b9e4c6-7033-4ea2-aed8-b32c5544bfb7</ontrue>
    <onfalse>b805d54f-56f8-4b15-917a-9366112b456e</onfalse>
  </stage>
  <stage stageid="b805d54f-56f8-4b15-917a-9366112b456e" name="Utility Custom - Collection Manipulation::Find Value in Collection(OEM)" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-465" w="120" h="60" />
    <inputs>
      <input type="collection" name="Input Collection" friendlyname="Input Collection" expr="[OEM  Collection]" />
      <input type="text" name="Key" friendlyname="Key" expr="[Vendor Name]" />
      <input type="text" name="Column to Search" friendlyname="Column to Search" expr="&quot;Supplier&quot;" />
      <input type="text" name="Column to get value from" friendlyname="Column to get value from" expr="&quot;Contract Email&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Value" friendlyname="Value" stage="Mail ID" />
    </outputs>
    <onsuccess>1472f562-704c-4b26-9197-808146ec292f</onsuccess>
    <resource object="Utility Custom - Collection Manipulation" action="Find Value in Collection with Contains(Multiple Values)" />
  </stage>
  <stage stageid="1472f562-704c-4b26-9197-808146ec292f" name="Checks Mail ID Value?" type="Decision">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-375" w="90" h="30" />
    <decision expression="[Mail ID]&lt;&gt;&quot;&quot;" />
    <ontrue>27610af1-3d57-4cb8-8a03-f321af334fa0</ontrue>
    <onfalse>d3244225-13ca-4e1c-8398-db984b347cb8</onfalse>
  </stage>
  <stage stageid="54d23fe9-8354-428d-8c6b-95ff6ce61be6" name="Forward Email to Third Party" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="285" y="-135" w="120" h="60" />
    <inputs>
      <input type="text" name="Mail ID" friendlyname="Mail ID" expr="[Data.New Item ID]" />
      <input type="text" name="To" friendlyname="To" expr="&quot;nachimuthus@avaya.com&quot;" />
      <input type="text" name="CC" friendlyname="CC" expr="[Forward CC MailID]" />
    </inputs>
    <outputs>
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
    </outputs>
    <onsuccess>c0e9dc0c-5a71-4c79-bd9c-cb530f4b570e</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <resource object="Email - Exchange Managed API" action="Forward Mail using ID " />
  </stage>
  <stage stageid="0357ade0-d6cd-47fe-bc2b-0497527a11f4" name="Email Classification Process_Third Party_MAILID" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-315" y="-285" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1d37e42e-7a69-400d-ba77-5b796e2256f4" name="Member Variables" type="Block">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-405" y="-375" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b12efd1d-9c94-4972-85b5-ebe2f8d3eda2" name="Set to MAil id(Temp)" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-210" />
    <onsuccess>4ce62272-6b1c-4dde-8e1c-902138294f91</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <calculation expression="&quot;pr7@avaya.com&quot;" stage="Mail ID" />
  </stage>
  <stage stageid="06204cfe-377c-4dcf-b11f-a2e208b9b816" name="Email - Exchange Managed API::Configure" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="75" y="-840" w="120" h="60" />
    <inputs>
      <input type="flag" name="UseWindowsCredentials" friendlyname="UseWindowsCredentials" narrative="Use Windows credentials of currently logged on user instead of providing separate credentials" expr="[Use Windows Credtinials]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to authenticate with Exchange " expr="[Username]" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to authenticate with Exchange " expr="[Password]" />
    </inputs>
    <onsuccess>1d8d59a4-c266-4eb5-82ee-eaf2d42de16c</onsuccess>
    <resource object="Email - Exchange Managed API" action="Configure" />
  </stage>
  <stage stageid="553578b1-0fb8-437d-8df6-5a0296c6e47b" name="Anchor15" type="Anchor">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="285" y="-375" w="10" h="10" />
    <onsuccess>54d23fe9-8354-428d-8c6b-95ff6ce61be6</onsuccess>
  </stage>
  <stage stageid="0965e74d-75a7-4970-8689-3014e1388526" name="Set to MAil id(Temp)" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-165" />
    <onsuccess>4ce62272-6b1c-4dde-8e1c-902138294f91</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <calculation expression="&quot;pr7@avaya.com&quot;" stage="Mail ID" />
  </stage>
  <stage stageid="4f2d7bde-4341-4e6e-b79f-04a85f22621a" name="Email Classification Process_Forward_CCMAILID" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-345" y="-225" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">michelcote@avaya.com,srinivasn@avaya.com

</initialvalue>
    <exposure>Environment</exposure>
    <alwaysinit />
  </stage>
  <stage stageid="77ff93a0-e6e4-46bb-8a36-92da5910bc51" name="Credentials::Get" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="210" y="-1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GSO Mailbox&quot;" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>06204cfe-377c-4dcf-b11f-a2e208b9b816</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="d27f2bc7-769a-40d5-a828-8e3b9e7343f8" name="Resellers Collection" type="Collection">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-360" y="-330" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c95aa604-7361-4cf5-bbe1-451a6d328432" name="OEM  Collection" type="Collection">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-285" y="-330" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9fff88d1-87b2-45c9-b907-d5fd2e503cf4" name="Mail ID Temp" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-285" y="-555" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="21054728-80bb-472e-aff2-527556ee0f01" name="Utility Custom - Collection Manipulation::Find Value in Collection(Resellers)" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="135" y="-630" w="120" h="60" />
    <inputs>
      <input type="collection" name="Input Collection" friendlyname="Input Collection" expr="[Resellers Collection]" />
      <input type="text" name="Key" friendlyname="Key" expr="[Vendor Name]" />
      <input type="text" name="Column to Search" friendlyname="Column to Search" expr="&quot;Supplier&quot;" />
      <input type="text" name="Column to get value from" friendlyname="Column to get value from" expr="&quot;Contract email&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Value" friendlyname="Value" stage="Mail ID" />
    </outputs>
    <onsuccess>8098e553-ea3c-4ffd-8d57-852c9de577fa</onsuccess>
    <resource object="Utility Custom - Collection Manipulation" action="Find Value in Collection with Contains(Multiple Values)" />
  </stage>
  <stage stageid="e2894d84-4c78-4fa0-8f3c-8bf0c3335b08" name="Forward Email Block" type="Block">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-150" y="-270" w="630" h="240" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="9875dfcc-e96f-4151-a7ec-3251d074bda0" name="Recover1" type="Recover">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="420" y="-345" w="90" h="60" />
    <onsuccess>48a3256b-712b-408e-ae2a-b76312ca66be</onsuccess>
  </stage>
  <stage stageid="48a3256b-712b-408e-ae2a-b76312ca66be" name="Resume1" type="Resume">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="570" y="-345" w="90" h="60" />
    <onsuccess>914be44d-230e-4dd4-9f21-528a1777110b</onsuccess>
  </stage>
  <stage stageid="95d1b356-5a76-4a46-abae-fdeb7cba88a3" name="Check Retry Count" type="Decision">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="570" y="-495" />
    <decision expression="[Exception Count]&lt;=[Retry Count]" />
    <ontrue>2eee8ee9-d324-42ab-93d9-077b1f273ccc</ontrue>
    <onfalse>5373c24d-7056-4c82-af68-8cc4bcd4942a</onfalse>
  </stage>
  <stage stageid="914be44d-230e-4dd4-9f21-528a1777110b" name="Inc Exception Count" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="570" y="-420" />
    <onsuccess>95d1b356-5a76-4a46-abae-fdeb7cba88a3</onsuccess>
    <calculation expression="[Exception Count]+1" stage="Exception Count" />
  </stage>
  <stage stageid="5373c24d-7056-4c82-af68-8cc4bcd4942a" name="MAIL ID NOT FOUND" type="Exception">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="690" y="-495" w="90" h="60" />
    <exception localized="yes" type="SystemException" detail="&quot;Can't able to get the mail id value from collection&quot;" />
  </stage>
  <stage stageid="b86553d5-12eb-4ef0-b707-21f3c54b3c5d" name="Count" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-390" y="-165" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="28ef1fd4-07e1-4c70-9af5-c5f44ec75699" name="Exception Count" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-165" />
    <datatype>number</datatype>
    <initialvalue>1</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6f90da59-01f9-4ac2-9286-3d9372ab5834" name="Retry Count" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="-165" />
    <datatype>number</datatype>
    <initialvalue>3</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2eee8ee9-d324-42ab-93d9-077b1f273ccc" name="Anchor24" type="Anchor">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="570" y="-915" w="10" h="10" />
    <onsuccess>06204cfe-377c-4dcf-b11f-a2e208b9b816</onsuccess>
  </stage>
  <stage stageid="3263b815-6cc2-4088-ab22-265456bb70c0" name="Checks Project Code" type="Decision">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="210" y="-750" />
    <decision expression="[Matched?]=True" />
    <ontrue>f2584b94-c79e-48cd-8b0a-c3c35a9f6390</ontrue>
    <onfalse>a49270df-3021-43aa-b796-9d9da4fb72a0</onfalse>
  </stage>
  <stage stageid="f2584b94-c79e-48cd-8b0a-c3c35a9f6390" name="Assigning Project Code Flag to true" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="300" y="-750" w="90" h="60" />
    <onsuccess>e1e8ff60-1c23-4f69-9c88-9d50fa30bb6e</onsuccess>
    <calculation expression="True" stage="Project Code Flag" />
  </stage>
  <stage stageid="1d8d59a4-c266-4eb5-82ee-eaf2d42de16c" name="Utility - Strings::Test Regex Match" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="75" y="-750" w="120" h="60" />
    <inputs>
      <input type="text" name="Regex Pattern" friendlyname="Regex Pattern" narrative="The regex pattern to apply" expr="&quot;[0-9][0-9]\SLE|[0-9][0-9]FD&quot;" />
      <input type="text" name="Target String" friendlyname="Target String" narrative="The target string to which apply the pattern and extract values" expr="Trim([Project Code])" />
    </inputs>
    <outputs>
      <output type="flag" name="Matched?" friendlyname="Matched?" narrative="Whether or not the regex match" stage="Matched?" />
    </outputs>
    <onsuccess>3263b815-6cc2-4088-ab22-265456bb70c0</onsuccess>
    <resource object="Utility - Strings" action="Test Regex Match" />
  </stage>
  <stage stageid="ff263a69-bf9b-4e61-b0e8-d6841616107b" name="Matched?" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-420" y="-795" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1b311457-2eb3-4535-8046-068bbada38d6" name="Project Code Flag" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-240" y="-660" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a49270df-3021-43aa-b796-9d9da4fb72a0" name="Anchor21" type="Anchor">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="210" y="-630" w="10" h="10" />
    <onsuccess>21054728-80bb-472e-aff2-527556ee0f01</onsuccess>
  </stage>
  <stage stageid="6bd2b99f-d41c-4bb0-89a2-e3019be59307" name="Setting the Result-Mail Forward" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="300" y="-555" w="90" h="60" />
    <onsuccess>ad057f63-d814-420f-8dfa-684ec25b2298</onsuccess>
    <calculation expression="&quot;Mail Forwarding Done&quot;" stage="Result Value" />
  </stage>
  <stage stageid="ad057f63-d814-420f-8dfa-684ec25b2298" name="End6" type="End">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="420" y="-555" w="90" h="60" />
    <outputs>
      <output type="text" name="Result Value" stage="Result Value" />
    </outputs>
  </stage>
  <stage stageid="c30f2cd2-44fc-496c-86a6-4f8ee26f15d8" name="Block2" type="Block">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-165" y="-690" w="645" h="390" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="fb5aebd7-c5ba-40f2-8834-caa9770aa860" name="Recover" type="Recover">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit />
    <display x="390" y="-840" w="90" h="60" />
    <onsuccess>fc9a93dd-9638-40bc-8cb5-eb8db665bd84</onsuccess>
  </stage>
  <stage stageid="fc9a93dd-9638-40bc-8cb5-eb8db665bd84" name="Project Code Match Exception" type="Exception">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="675" y="-840" w="150" h="30" />
    <exception localized="yes" type="System Excepetion" detail="ExceptionDetail()" />
  </stage>
  <stage stageid="6e6f17bc-0e08-4e99-978e-17f0baa3c472" name="Contruct and Send Email" type="SubSheetInfo">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="-510" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="bbfa1147-afff-452f-9051-412c62bf5ec4" name="Start" type="Start">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="-330" w="90" h="60" />
    <inputs>
      <input type="text" name="Exception Message" stage="Exception Message" />
      <input type="text" name="Exception Type" stage="Exception Type" />
      <input type="number" name="Item Count" stage="Item Count" />
      <input type="text" name="Excel Path" stage="Excel Path" />
    </inputs>
    <onsuccess>12cbd139-c3d0-4a71-ae91-609e97c3ab87</onsuccess>
  </stage>
  <stage stageid="c48931fb-1f5f-4c8d-aa29-4f948d7c1c81" name="End" type="End">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="195" w="90" h="60" />
  </stage>
  <stage stageid="42e73e24-485e-40ce-8065-dcd2019df59f" name="To Mail" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="285" y="-30" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">carputharaj@avaya.com;mnabeela@avaya.com</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7b9c56e3-376d-450d-927c-112a02f63548" name="BCC" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="450" y="60" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a0a2a300-e3a2-4a1f-8f7e-6e0f5040a3fa" name="Email Subject" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="285" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Email Classification</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c7c98f72-c6c2-47dd-9358-29a8398c5c97" name="Message Body" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="285" y="60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">FYI</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="490193e2-e033-41a9-9b07-f7498dd7f699" name="Attachments" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="450" y="15" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="af9388f0-1890-472b-a019-83bd53d40422" name="Mail CC" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="450" y="-30" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1688b22a-d340-4e4f-89c4-d0844ada2fbf" name="Member Variables" type="Block">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-120" w="375" h="300" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="b22a9746-65b9-4e51-a487-e854b2b93bc8" name="Mail Sending" type="SubSheet">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="60" w="120" h="60" />
    <inputs>
      <input type="text" name="In To Mail" friendlyname="In To Mail" expr="[To Mail]" />
      <input type="text" name="In Mail CC" friendlyname="In Mail CC" expr="[Mail CC]" />
      <input type="text" name="In Subject" friendlyname="In Subject" expr="[Email Subject]" />
      <input type="text" name="In Message Body" friendlyname="In Message Body" expr="[Message Body]" />
      <input type="text" name="In Attachments" friendlyname="In Attachments" expr="[Excel Path]" />
    </inputs>
    <onsuccess>c48931fb-1f5f-4c8d-aa29-4f948d7c1c81</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>270d450b-e968-4a72-929d-803d10468bcd</processid>
  </stage>
  <stage stageid="4c6a66f7-5554-476d-b466-b4f77a40a719" name="Sub Temp" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="405" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO- Email Classification </initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="97b4c595-1314-4e86-900d-243904e4dd83" name="Body Temp" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="255" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;body&gt;

&lt;p&gt;Greetings, &lt;/p&gt;



&lt;br/&gt;
&lt;p&gt;Note:This is an auto generated email.Please do not reply.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e84a14e6-e523-45f3-8698-1661c317c7e3" name="Exception Message" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="330" y="105" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6adec068-a2fe-41dc-9155-a8b211d830e6" name="Is Exception Message ?" type="Decision">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="-150" w="90" h="60" />
    <decision expression="[Exception Message]&lt;&gt;&quot;&quot;" />
    <ontrue>5e029dfc-3747-4118-bbf7-c40eafec81f1</ontrue>
    <onfalse>27f59e05-cc49-4c0e-9e07-5927d91e4973</onfalse>
  </stage>
  <stage stageid="31e836d1-dbfa-4eaa-9b7a-c67081f11445" name="Set Message Body(Exception details)" type="MultipleCalculation">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="-165" y="60" w="90" h="60" />
    <onsuccess>b22a9746-65b9-4e51-a487-e854b2b93bc8</onsuccess>
    <steps>
      <calculation expression="Replace([Exception Body Temp], &quot;{Exception Details}&quot;, [Exception Message])" stage="Message Body" />
      <calculation expression="[Sub Temp]" stage="Email Subject" />
    </steps>
  </stage>
  <stage stageid="5e8a62e5-a35d-4769-aafa-115311f5d21d" name="Completion  Body Temp" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="450" y="105" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;body&gt;

&lt;p&gt;Greetings, &lt;/p&gt;

&lt;p&gt;Please find the attached file for the items processed details:&lt;/p&gt;

&lt;p&gt;Item Count:{Item Count}&lt;/p&gt;



&lt;br/&gt;
&lt;p&gt;Note:This is an auto generated email.Please do not reply.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5e029dfc-3747-4118-bbf7-c40eafec81f1" name="Set Message Body" type="MultipleCalculation">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="-30" w="90" h="60" />
    <onsuccess>b22a9746-65b9-4e51-a487-e854b2b93bc8</onsuccess>
    <steps>
      <calculation expression="Replace([Exception Body Temp], &quot;{Exception Details}&quot;, [Exception Message])" stage="Message Body" />
      <calculation expression="[Sub Temp]" stage="Email Subject" />
    </steps>
  </stage>
  <stage stageid="12cbd139-c3d0-4a71-ae91-609e97c3ab87" name="Is Exception Type Business?" type="Decision">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="15" y="-240" w="90" h="60" />
    <decision expression="[Exception Type]=&quot;Business Exception&quot;" />
    <ontrue>7f9a85ef-adce-4f44-9dda-19b5904207d8</ontrue>
    <onfalse>6adec068-a2fe-41dc-9155-a8b211d830e6</onfalse>
  </stage>
  <stage stageid="779e1ec6-8b97-42b4-9401-6bdca2a79a0e" name="Exception Type" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="225" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7f9a85ef-adce-4f44-9dda-19b5904207d8" name="Anchor12" type="Anchor">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-165" y="-240" w="10" h="10" />
    <onsuccess>31e836d1-dbfa-4eaa-9b7a-c67081f11445</onsuccess>
  </stage>
  <stage stageid="27f59e05-cc49-4c0e-9e07-5927d91e4973" name="Set Message Body(Completion details)" type="MultipleCalculation">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <display x="120" y="-150" w="90" h="60" />
    <onsuccess>eaefcd60-021e-48bd-8673-2062a157797f</onsuccess>
    <steps>
      <calculation expression="Replace([Completion  Body Temp], &quot;{Item Count}&quot;, [Item Count])" stage="Message Body" />
      <calculation expression="[Sub Temp]" stage="Email Subject" />
    </steps>
  </stage>
  <stage stageid="eaefcd60-021e-48bd-8673-2062a157797f" name="Anchor8" type="Anchor">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="60" w="10" h="10" />
    <onsuccess>b22a9746-65b9-4e51-a487-e854b2b93bc8</onsuccess>
  </stage>
  <stage stageid="0ace8757-8bcf-43dc-ae33-e272cd8c8554" name="Email Classification Process_Third Party_MAILID" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="270" y="150" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8605dc52-7528-4c01-be01-525b2c414f1b" name="Exception Body Temp" type="Data">
    <subsheetid>c10b0887-463e-428e-ba34-965b06fe4bdd</subsheetid>
    <loginhibit />
    <display x="420" y="150" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;body&gt;

&lt;p&gt;Greetings, &lt;/p&gt;

&lt;p&gt;Please find the below exception details&lt;/p&gt;

&lt;p&gt;{Exception Details}&lt;/p&gt;



&lt;br/&gt;
&lt;p&gt;Note:This is an auto generated email.Please do not reply.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ff524bcd-da9c-492e-85b0-04b5641bcb75" name="Contruct and Send Email - table template" type="SubSheetInfo">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="-510" y="-210" w="150" h="90" />
  </stage>
  <stage stageid="3597e7c8-ffc8-459f-a30e-6f462cf00fc2" name="Start" type="Start">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="-435" w="90" h="60" />
    <inputs>
      <input type="text" name="Exception Message" stage="Exception Message" />
      <input type="text" name="Subject" stage="Email Subject" />
      <input type="text" name="Exception Type" stage="Exception Type" />
      <input type="number" name="Item Count" stage="Item Count" />
      <input type="text" name="Excel Path" stage="Excel Path" />
      <input type="text" name="Sender Email Address" stage="Sender Email Address" />
      <input type="text" name="Sender Name" stage="Sender Name" />
      <input type="flag" name="Project Code Flag" stage="Project Code Flag" />
    </inputs>
    <onsuccess>e3e68902-b6d5-4654-937b-d5879cf769ab</onsuccess>
  </stage>
  <stage stageid="1543ef52-9ecd-43c1-9755-f160d9b918c6" name="End" type="End">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="180" w="90" h="60" />
  </stage>
  <stage stageid="6f06495f-c358-4969-aeee-1add7274d694" name="To Mail" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="390" y="-45" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">carputharaj@avaya.com;mnabeela@avaya.com</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f0af9194-4f2b-4592-9381-74941e7bd75a" name="BCC" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="555" y="45" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="35549e44-d397-4a13-8b08-7569ee389e0c" name="Email Subject" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="390" y="0" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Email Classification</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="20d62d68-9ce0-42e9-85df-097fd4612a8c" name="Message Body" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="390" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">FYI</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9cf89713-aa25-4617-9e8f-f306079e9c21" name="Attachments" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="555" y="0" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b5de010c-e2f6-4785-9834-122ed2f263ac" name="Mail CC" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="555" y="-45" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ed9fb391-3ee0-4c62-9920-550caa50bc3f" name="Member Variables" type="Block">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="255" y="-135" w="375" h="300" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3a79f755-a0df-475f-8d69-41b7fbda5f04" name="Mail Sending" type="SubSheet">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="30" w="120" h="60" />
    <inputs>
      <input type="text" name="In To Mail" friendlyname="In To Mail" expr="[To Mail]" />
      <input type="text" name="In Mail CC" friendlyname="In Mail CC" expr="[Email Classification Process_Forward_CCMAILID]" />
      <input type="text" name="In Subject" friendlyname="In Subject" expr="[Email Subject]" />
      <input type="text" name="In Message Body" friendlyname="In Message Body" expr="[Message Body]" />
      <input type="text" name="In Attachments" friendlyname="In Attachments" expr="[Excel Path]" />
    </inputs>
    <onsuccess>1543ef52-9ecd-43c1-9755-f160d9b918c6</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
    <processid>270d450b-e968-4a72-929d-803d10468bcd</processid>
  </stage>
  <stage stageid="924b50a6-48e3-4693-a518-f77a55ab9d1c" name="Sub Temp" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="510" y="-105" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO- Email Classification </initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eb927cb8-116b-49d2-8dd8-16abb3526dce" name="Body Temp" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="360" y="-105" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;head&gt;
&lt;style&gt;
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
  table-layout: fixed;
}
th, td {
  padding: 5px;
  text-align: left;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;please fill out the following information when sending your request to OEMSWSERVICES@avaya.com every time and also include the same subject while sending email (also will need a copy of the APS approval e-mail, along with all required documentation).&lt;/p&gt;&lt;br/&gt;

&lt;table style="width:100%"&gt;
  &lt;tr&gt;
    &lt;th colspan="2" style="background: #fabf8f"&gt;GSO Third Party Services Approval Request&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width="500"&gt;End Customer Name&lt;/td&gt;
    &lt;td &gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width="500"&gt;Project Summary&lt;/td&gt;
    &lt;td &gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Name of Third Party Supplier&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Project Code&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Direct or Indirect / Partner Name&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Third Party services being proposed&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Cost to Avaya&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Avaya Net Price to Customer (After Discount) - Third Party Services Only, not APS Services&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Margin Percentage&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Senior management email approval if the margin is &lt; 35%&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Both SOWs attached? Supplier and Avaya  SOWs?&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;tr&gt;
    &lt;td width="500"&gt;Both Quotes attached? Supplier and Avaya quote spreadsheets?&lt;/td&gt;
    &lt;td&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;
&lt;br/&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cf9f5fcd-4f76-4f7c-a026-454ab4e146bf" name="Exception Message" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="435" y="90" w="120" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6876ac21-432b-42e2-bb12-88763283ee98" name="Completion  Body Temp" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="555" y="90" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;body&gt;

&lt;p&gt;Greetings, &lt;/p&gt;

&lt;p&gt;Please find the attached file for the items processed details:&lt;/p&gt;

&lt;p&gt;Item Count:{Item Count}&lt;/p&gt;



&lt;br/&gt;
&lt;p&gt;Note:This is an auto generated email.Please do not reply.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="620eb36e-8d4b-4096-a542-aa75bc8a13ef" name="Set Message Body" type="MultipleCalculation">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="-75" w="90" h="60" />
    <onsuccess>3a79f755-a0df-475f-8d69-41b7fbda5f04</onsuccess>
    <steps>
      <calculation expression="[Body Temp]" stage="Message Body" />
      <calculation expression="[Subject]" stage="Email Subject" />
    </steps>
  </stage>
  <stage stageid="9a279575-6585-4845-9ba0-1bc345c34ec0" name="Is Exception Type Business?" type="Decision">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="-270" w="90" h="60" />
    <decision expression="[Exception Type]=&quot;Business Exception&quot;" />
    <ontrue>5c1c4173-258d-43d6-8b85-25f9cc8f9f8f</ontrue>
    <onfalse>3ed02ea9-2d3e-4c5b-8ae0-dbbb5f3b8761</onfalse>
  </stage>
  <stage stageid="0d3664c8-4f1f-43c0-9282-3f53104fef2f" name="Exception Type" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="330" y="90" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="01ddb1b4-fa45-419b-8866-a4badd87f8fe" name="Email Classification Process_Third Party_MAILID" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="375" y="135" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <exposure>Environment</exposure>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a9a9d507-595d-405c-8315-93963cb0d909" name="Exception Body Temp" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="525" y="135" w="150" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;body&gt;

&lt;p&gt;Greetings, &lt;/p&gt;

&lt;p&gt;Please find the below exception details&lt;/p&gt;

&lt;p&gt;{Exception Details}&lt;/p&gt;



&lt;br/&gt;
&lt;p&gt;Note:This is an auto generated email.Please do not reply.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5c1c4173-258d-43d6-8b85-25f9cc8f9f8f" name="Set Sender Name to Mail ID" type="Calculation">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="-180" w="90" h="60" />
    <onsuccess>620eb36e-8d4b-4096-a542-aa75bc8a13ef</onsuccess>
    <calculation expression="[Sender Email Address]" stage="To Mail" />
  </stage>
  <stage stageid="3ed02ea9-2d3e-4c5b-8ae0-dbbb5f3b8761" name="End4" type="End">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="-270" w="90" h="60" />
  </stage>
  <stage stageid="ccf37195-c794-484d-bf42-c939a0f345f2" name="Body Temp Project Code" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <loginhibit />
    <display x="465" y="-240" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;Hi,&lt;/p&gt;&lt;br/&gt;
&lt;p&gt;This project is for Federal, State, Local, or Education and should be directly sent to the following GSO Commodity Managers based on the project needs..&lt;/p&gt;&lt;br/&gt;
&lt;ul&gt;
  &lt;li&gt;Reseller Third Party Supplier:  Barry Marcus (bpmarcus@avaya.com), Randy Sisk (jrsisk@avaya.com), Leonarda Rahal (lprahal@avaya.com)&lt;/li&gt;&lt;br/&gt;
  &lt;li&gt;Third Party Services/Other Government Projects:  Charlene Tourison (cbtourison@avaya.com) and Denise Cools-Lartigue (dcoolslartig@avaya.com)&lt;/li&gt;&lt;br/&gt;
&lt;/ul&gt; 
&lt;br/&gt;
&lt;p&gt;Thanks&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e3e68902-b6d5-4654-937b-d5879cf769ab" name="Checks the Project Code Flag?" type="Decision">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="15" y="-360" w="90" h="60" />
    <decision expression="[Project Code Flag]=True" />
    <ontrue>c85aecbc-9bb4-4ffc-b457-c08fcadd7840</ontrue>
    <onfalse>9a279575-6585-4845-9ba0-1bc345c34ec0</onfalse>
  </stage>
  <stage stageid="54781c08-1202-4f09-8231-8d2700bd5023" name="Contruct and Send Email - table template(For Project Codes)" type="SubSheet">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="-195" y="180" w="120" h="60" />
    <inputs>
      <input type="text" name="In To Mail" friendlyname="In To Mail" expr="[To Mail]" />
      <input type="text" name="In Mail CC" friendlyname="In Mail CC" expr="[Email Classification Process_Forward_CCMAILID]" />
      <input type="text" name="In Subject" friendlyname="In Subject" expr="[Email Subject]" />
      <input type="text" name="In Message Body" friendlyname="In Message Body" expr="[Message Body]" />
      <input type="text" name="In Attachments" friendlyname="In Attachments" expr="[Excel Path]" />
    </inputs>
    <onsuccess>1543ef52-9ecd-43c1-9755-f160d9b918c6</onsuccess>
    <processid>270d450b-e968-4a72-929d-803d10468bcd</processid>
  </stage>
  <stage stageid="3f51459a-c9d5-44aa-8e5e-f3d9add3f4ca" name="Set Message Body" type="MultipleCalculation">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="-195" y="-120" w="90" h="60" />
    <onsuccess>54781c08-1202-4f09-8231-8d2700bd5023</onsuccess>
    <steps>
      <calculation expression="[Body Temp Project Code]" stage="Message Body" />
      <calculation expression="[Subject]" stage="Email Subject" />
    </steps>
  </stage>
  <stage stageid="c85aecbc-9bb4-4ffc-b457-c08fcadd7840" name="Set Sender Name to Mail ID" type="Calculation">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="-195" y="-360" w="90" h="60" />
    <onsuccess>3f51459a-c9d5-44aa-8e5e-f3d9add3f4ca</onsuccess>
    <calculation expression="[Sender Email Address]" stage="To Mail" />
  </stage>
  <stage stageid="0d025d0d-765e-42ef-b340-8134c8043e35" name="Project Code Flag" type="Data">
    <subsheetid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</subsheetid>
    <display x="480" y="-285" w="120" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e1e8ff60-1c23-4f69-9c88-9d50fa30bb6e" name="Contruct and Send Email(Tabular Format)" type="SubSheet">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="300" y="-645" w="120" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="&quot;Business Exception&quot; " />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="[Excel Path]" />
      <input type="text" name="Sender Name" friendlyname="Sender Name" expr="[Sender Name]" />
      <input type="text" name="Sender Email Address" friendlyname="Sender Email Address" expr="Trim([Sender Email Address])" />
      <input type="text" name="Subject" friendlyname="Subject" expr="[Subject]" />
      <input type="flag" name="Project Code Flag" friendlyname="Project Code Flag" expr="[Project Code Flag]" />
    </inputs>
    <onsuccess>6bd2b99f-d41c-4bb0-89a2-e3019be59307</onsuccess>
    <processid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</processid>
  </stage>
  <stage stageid="7218952d-f801-460e-8eeb-00c3a92802df" name="Contruct and Send Email(Tabular Format)" type="SubSheet">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="930" w="120" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="&quot;Business Exception&quot; " />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="[Excel Path]" />
      <input type="text" name="Sender Name" friendlyname="Sender Name" expr="[Sender Name]" />
      <input type="text" name="Sender Email Address" friendlyname="Sender Email Address" expr="Trim([Sender Email Address])" />
      <input type="text" name="Subject" friendlyname="Subject" expr="[Subject]" />
      <input type="flag" name="Project Code Flag" friendlyname="Project Code Flag" expr="" />
    </inputs>
    <onsuccess>6432e931-b33e-48e4-8080-4bc011c17513</onsuccess>
    <processid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</processid>
  </stage>
  <stage stageid="3dcfa98b-3b80-4e2f-a33b-755171d26d55" name="Get Vendor Name(Third-Party Supplier)" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="390" y="285" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Name of Third-Party Supplier&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Project Code&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Vendor name" />
    </outputs>
    <onsuccess>16930d82-4634-4fdf-87bd-179d858a4f72</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="fac09a4f-2124-4fa5-8d78-92b8d2f915dd" name="Get Project Code Block" type="Block">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-135" y="240" w="855" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="5b0dfd70-1936-4f1a-a2b8-d4b69b8092ad" name="Recover" type="Recover">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="540" y="300" w="120" h="60" />
    <onsuccess>d740bb01-b4bb-4b64-8527-f917721b19ea</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="9c7d6f0c-a379-4f69-921b-23ee090a3083" name="Resume" type="Resume">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit />
    <display x="780" y="300" w="90" h="60" />
    <onsuccess>d39071c4-66e0-4ce3-9587-b2297eb513cd</onsuccess>
  </stage>
  <stage stageid="d740bb01-b4bb-4b64-8527-f917721b19ea" name="Set to Exception Detail" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="300" />
    <onsuccess>9c7d6f0c-a379-4f69-921b-23ee090a3083</onsuccess>
    <calculation expression="ExceptionDetail()&amp;&quot;;&quot;&amp;&quot;Can't able to get third party supplier in the email&quot;" stage="Exception Message" />
  </stage>
  <stage stageid="d39071c4-66e0-4ce3-9587-b2297eb513cd" name="Anchor34" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="780" y="405" w="10" h="10" />
    <onsuccess>4f3adfec-1f17-43c0-b15a-996e1870841c</onsuccess>
  </stage>
  <stage stageid="16930d82-4634-4fdf-87bd-179d858a4f72" name="Check Vendor Name?" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="180" y="285" />
    <decision expression="[Vendor name]=&quot;&quot;" />
    <ontrue>632cb3b3-3632-47f5-b120-ce6f94778749</ontrue>
    <onfalse>38a9e491-0c3f-4997-b4ce-6f6007b55131</onfalse>
  </stage>
  <stage stageid="632cb3b3-3632-47f5-b120-ce6f94778749" name="Vendor Name not found" type="Exception">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="180" y="315" w="90" h="30" />
    <exception localized="yes" type="Business Exception" detail="&quot;Third Party Supplier Name doesn't exits in the mail&quot;" />
  </stage>
  <stage stageid="c330653b-4049-46cf-a7c7-18834878fee6" name="Forward CC MailID" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="-330" />
    <onsuccess>4ce62272-6b1c-4dde-8e1c-902138294f91</onsuccess>
    <calculation expression="[Email Classification Process_Forward_CCMAILID]&amp;&quot;;&quot;&amp;[Sender Email Address]" stage="Forward CC MailID" />
  </stage>
  <stage stageid="6e0f460e-0b52-45e3-92d7-a9f43e5192ea" name="Forward CC MailID" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-255" y="-105" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3244225-13ca-4e1c-8398-db984b347cb8" name="Forward CC MailID" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="240" y="-375" />
    <onsuccess>553578b1-0fb8-437d-8df6-5a0296c6e47b</onsuccess>
    <calculation expression="[Email Classification Process_Forward_CCMAILID]&amp;&quot;;&quot;&amp;[Sender Email Address]" stage="Forward CC MailID" />
  </stage>
  <stage stageid="8b0036cc-0379-46a4-bd8a-061d75c842fb" name="Utility Custom - Collection Manipulation::Removing Duplicates" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-495" w="90" h="30" />
    <inputs>
      <input type="collection" name="SourceColl" friendlyname="SourceColl" expr="[Split Values]" />
    </inputs>
    <outputs>
      <output type="collection" name="OutColl" friendlyname="OutColl" stage="OutColl" />
    </outputs>
    <onsuccess>c8135593-897c-416b-b45b-b29ec30fde4a</onsuccess>
    <resource object="Utility Custom - Collection Manipulation" action="Removing Duplicates" />
  </stage>
  <stage stageid="7fe4a557-0da7-4d4f-ae27-cf436975c74b" name="Utility - Strings::Split Text" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-540" w="90" h="30" />
    <inputs>
      <input type="text" name="Text to Split" friendlyname="Text to Split" narrative="The text to split" expr="[Mail ID]" />
      <input type="text" name="Split Char" friendlyname="Split Char" narrative="The split delimiter" expr="&quot;;&quot;" />
      <input type="text" name="Collection Field Name" friendlyname="Collection Field Name" narrative="The name of the field for the resulting collection" expr="&quot;Mail ID&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Split Values" friendlyname="Split Values" narrative="The resulting collection containing the split values" stage="Split Values" />
    </outputs>
    <onsuccess>8b0036cc-0379-46a4-bd8a-061d75c842fb</onsuccess>
    <resource object="Utility - Strings" action="Split Text" />
  </stage>
  <stage stageid="d05b5696-4b89-40ba-8ef6-ca82c92a8f03" name="Split Values" type="Collection">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-330" y="-735" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="17e3af81-478c-4ca8-a5b8-6012b47ecf99" name="OutColl" type="Collection">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-330" y="-690" w="120" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1ae57c38-ba7d-4244-9430-57358730895f" name="Loop Start1" type="LoopStart">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-75" y="-420" />
    <onsuccess>10057a17-6d15-44a6-a2ba-b28321495b56</onsuccess>
    <groupid>86c58ddb-cae3-4b9a-bfbc-1b22c91afa51</groupid>
    <looptype>ForEach</looptype>
    <loopdata>OutColl</loopdata>
  </stage>
  <stage stageid="5be0954b-d39b-4094-9204-647e8a470910" name="Loop End1" type="LoopEnd">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-75" y="-330" />
    <onsuccess>f76ebbae-a4b9-4b45-8b9b-60b1eb8421e6</onsuccess>
    <groupid>86c58ddb-cae3-4b9a-bfbc-1b22c91afa51</groupid>
  </stage>
  <stage stageid="10057a17-6d15-44a6-a2ba-b28321495b56" name="Multi1" type="MultipleCalculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-75" y="-375" />
    <onsuccess>5be0954b-d39b-4094-9204-647e8a470910</onsuccess>
    <steps>
      <calculation expression="[OutColl.Mail ID]" stage="Temp MailID" />
      <calculation expression="[Temp MailID]&amp;&quot;;&quot;&amp;[Mail ID]" stage="Mail ID" />
    </steps>
  </stage>
  <stage stageid="a5bc4213-4fcc-4902-8596-a5aa17738fd2" name="Temp MailID" type="Data">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <display x="-330" y="-630" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2494646d-8d82-4778-926b-7de9038f833e" name="Reset MailID" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-405" />
    <onsuccess>1ae57c38-ba7d-4244-9430-57358730895f</onsuccess>
    <calculation expression="&quot;&quot;" stage="Mail ID" />
  </stage>
  <stage stageid="f76ebbae-a4b9-4b45-8b9b-60b1eb8421e6" name="Remove semicolan MailID" type="Calculation">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-330" />
    <onsuccess>c330653b-4049-46cf-a7c7-18834878fee6</onsuccess>
    <calculation expression="Left([Mail ID], Len([Mail ID])-1)" stage="Mail ID" />
  </stage>
  <stage stageid="c8135593-897c-416b-b45b-b29ec30fde4a" name="Utility Custom - Collection Manipulation::Remove Empty Rows" type="Action">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-450" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection In" friendlyname="Collection In" narrative="The collection to remove empty rows from" expr="[OutColl]" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Out" friendlyname="Collection Out" narrative="The collection with the empty rows removed" stage="OutColl" />
    </outputs>
    <onsuccess>2494646d-8d82-4778-926b-7de9038f833e</onsuccess>
    <resource object="Utility - Collection Manipulation" action="Remove Empty Rows" />
  </stage>
  <stage stageid="27610af1-3d57-4cb8-8a03-f321af334fa0" name="Anchor42" type="Anchor">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-375" w="10" h="10" />
    <onsuccess>c1b9e4c6-7033-4ea2-aed8-b32c5544bfb7</onsuccess>
  </stage>
  <stage stageid="c1b9e4c6-7033-4ea2-aed8-b32c5544bfb7" name="Anchor43" type="Anchor">
    <subsheetid>e311f5fd-8469-4a14-b402-9267a5d39ffb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-540" w="10" h="10" />
    <onsuccess>7fe4a557-0da7-4d4f-ae27-cf436975c74b</onsuccess>
  </stage>
  <stage stageid="89556521-cd1b-44e3-b122-b9838edf4201" name="Utility - General::Sleep" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-735" w="120" h="60" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="3" />
    </inputs>
    <onsuccess>1030e6e6-5a88-44f2-8a3b-b0f68d911933</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="cc8230b6-cdc3-4918-a3d5-d3444760a928" name="Populate Queue - Copy" type="SubSheetInfo">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-375" y="-705" w="150" h="90" />
  </stage>
  <stage stageid="2e301c45-4851-4f8f-a1cb-a88f3f555870" name="Start" type="Start">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-45" y="-945" w="120" h="60" />
    <onsuccess>58687617-c680-4c83-b694-a67a24aa666d</onsuccess>
  </stage>
  <stage stageid="a09f3535-17ec-41c0-89c7-abe24ffa24ac" name="End" type="End">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="1380" w="120" h="60" />
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="58687617-c680-4c83-b694-a67a24aa666d" name="Email - Exchange Managed API::Configure" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-825" w="120" h="60" />
    <inputs>
      <input type="flag" name="UseWindowsCredentials" friendlyname="UseWindowsCredentials" narrative="Use Windows credentials of currently logged on user instead of providing separate credentials" expr="[Use Windows Credtinials]" />
      <input type="text" name="Username" friendlyname="Username" narrative="The username to authenticate with Exchange " expr="[Username]" />
      <input type="password" name="Password" friendlyname="Password" narrative="The password to authenticate with Exchange " expr="[Password]" />
    </inputs>
    <onsuccess>c28330e3-ab7b-4561-a46e-2261625db52f</onsuccess>
    <resource object="Email - Exchange Managed API" action="Configure" />
  </stage>
  <stage stageid="3fae6642-50e3-4147-86e7-5dd71e0168f4" name="Email - Exchange Managed API::List Mails Within DateTimes" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="0" y="-765" w="120" h="60" />
    <inputs>
      <input type="text" name="Sub-Folder" friendlyname="Sub-Folder" narrative="Optional. The name of a sub-folder below the Inbox from which to get emails.  If not set the Inbox will be used." expr="[SubFolder Name]" />
      <input type="flag" name="Unread Only?" friendlyname="Unread Only?" narrative="If True than only get unread emails, otherwise get any" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="collection" name="IDs" friendlyname="IDs" stage="IDs" />
    </outputs>
    <onsuccess>b3a9a72f-3679-4fb2-af4e-62ef34225c46</onsuccess>
    <resource object="Email - Exchange Managed API" action="List Mails Within DateTimes" />
  </stage>
  <stage stageid="05aa3e85-c6c0-4414-b999-2c3d93e813ec" name="IDs" type="Collection">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-345" y="-465" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8827b8ab-8f31-4604-82a2-912955ace5cd" name="ID Loop" type="LoopStart">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-120" w="120" h="60" />
    <onsuccess>c1549ae5-902b-45c5-8d6a-a64e778cfb13</onsuccess>
    <groupid>385e0d7d-a421-4014-bc1c-6d5eae47ee15</groupid>
    <looptype>ForEach</looptype>
    <loopdata>IDs</loopdata>
  </stage>
  <stage stageid="c47b5c3b-16ce-4b91-9fbb-b49f10b49848" name="ID Loop" type="LoopEnd">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="1245" w="150" h="60" />
    <onsuccess>a09f3535-17ec-41c0-89c7-abe24ffa24ac</onsuccess>
    <groupid>385e0d7d-a421-4014-bc1c-6d5eae47ee15</groupid>
  </stage>
  <stage stageid="3bbf5259-7090-4229-bfa0-d3ff09d90935" name="Success" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-525" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0f6a2b24-a8bc-4c3a-93a6-6d51bba20fa5" name="Error Message" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="495" y="-525" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c1549ae5-902b-45c5-8d6a-a64e778cfb13" name="Email - Exchange Managed API::Get Mail using ID" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-45" w="120" h="60" />
    <inputs>
      <input type="text" name="Attachment Directory" friendlyname="Attachment Directory" expr="[Directory Path]" />
      <input type="text" name="Mail ID" friendlyname="Mail ID" expr="[IDs.ID]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="Sender Name" friendlyname="Sender Name" stage="Sender Name" />
      <output type="text" name="Sender Email Address" friendlyname="Sender Email Address" stage="Sender Email Address" />
      <output type="text" name="Subject" friendlyname="Subject" stage="Subject" />
      <output type="text" name="Message Body" friendlyname="Message Body" stage="Message Body" />
      <output type="text" name="Attachment Names" friendlyname="Attachment Names" stage="" />
      <output type="text" name="ID" friendlyname="ID" stage="ID" />
    </outputs>
    <onsuccess>09f1302f-6e28-44b6-a566-1514e363e1c0</onsuccess>
    <resource object="Email - Exchange Managed API" action="Get Mail using ID" />
  </stage>
  <stage stageid="09f1302f-6e28-44b6-a566-1514e363e1c0" name="Get Vendor Name" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="75" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Name of Third Party Supplier&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Project Code&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Vendor name" />
    </outputs>
    <onsuccess>52b5e904-09ae-4005-98df-0d3157e3cec7</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="256404c2-2c50-4672-a03f-4036b42c9bcf" name="Subject" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-480" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Automatic reply:GSO Approval</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="9a0dd203-b887-408a-b3e0-13671fd505f8" name="Message Body" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="480" y="-435" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1a98532d-c491-4087-ac19-c899bd5324f0" name="ID" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="480" y="-480" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="88284f20-9c1d-4ab4-93ff-1a5beb513918" name="Vendor name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-435" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="88eb88fe-0a98-456f-8a58-fb64e0092c4d" name="Work Queues::Add To Queue" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibitparameters />
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="-15" y="1050" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Work Queue Name]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Input Collection]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;Ready to Start checking for vendor name&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="Item IDs" />
    </outputs>
    <onsuccess>c47b5c3b-16ce-4b91-9fbb-b49f10b49848</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="82c08c59-7bf4-473b-a132-7ec0ce99627f" name="Item Key" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-390" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="72218f8e-77ff-4810-8b51-921d15c11031" name="Item IDs" type="Collection">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="480" y="-390" w="90" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="323469ba-127e-4b0a-a902-a64519f60386" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="750" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="[SubFolder Completed Name]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>cb6a48e8-06e1-4d11-8062-15425c28c590</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="cb6a48e8-06e1-4d11-8062-15425c28c590" name="Setting the ID" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="750" w="120" h="60" />
    <onsuccess>2fb1697d-6978-4b94-a226-01176e27fec0</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="9ea91966-e84d-4607-8979-9b8170305fdb" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="675" w="120" h="60" />
    <onsuccess>323469ba-127e-4b0a-a902-a64519f60386</onsuccess>
    <steps>
      <calculation expression="Trim(Lower([Vendor name]))" stage="Input Collection.Vendor Name" />
      <calculation expression="Trim([Project code])" stage="Input Collection.Project Code" />
      <calculation expression="Trim([Subject])&amp;&quot;_&quot;&amp;Trim([Project code])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="b3c3a5ed-8bb3-4407-89c6-2424e90084c6" name="Anchor2" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="1245" w="10" h="10" />
    <onsuccess>c47b5c3b-16ce-4b91-9fbb-b49f10b49848</onsuccess>
  </stage>
  <stage stageid="b3a9a72f-3679-4fb2-af4e-62ef34225c46" name="Checks the mail" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="0" y="-705" w="120" h="60" />
    <decision expression="InStr([Error Message], &quot;No mails found in the folder&quot;)&gt;0" />
    <ontrue>541cd42d-f4fd-4ef0-bbc4-0f1963a45b29</ontrue>
    <onfalse>23e3f120-e244-40dd-9bc3-f18b0ce92efe</onfalse>
  </stage>
  <stage stageid="541cd42d-f4fd-4ef0-bbc4-0f1963a45b29" name="End3" type="End">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-705" w="90" h="60" />
  </stage>
  <stage stageid="d9e8208a-1c7b-43cd-9478-d9c89a99688e" name="SubFolder Name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-345" y="-510" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Inbox</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="49221c53-40ae-4d8e-9974-d33df0e4bc15" name="Directory Path" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-435" y="-510" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">C:\BP_files\GSO\Attachments</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="e6defd80-9ec8-4a63-af25-c9c0b0dc8552" name="SubFolder Completed Name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-450" y="-465" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Completed</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e4cd5bcc-6410-43e0-a4af-f69b63dfb4a1" name="Member Variables" type="Block">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-510" y="-585" w="240" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="caf9b3d9-e007-46f6-9d0b-8a1c46af047c" name="Member Variables" type="Block">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="345" y="-600" w="210" h="330" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="3fff947b-86ad-417f-8c62-c993d59507a5" name="Work Queue Name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-345" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">GSO Email Classification</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="56c51265-59cc-4276-abd7-a400bc37fdb3" name="New Mail Id" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="480" y="-345" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5ae84c34-c69d-4da9-9488-205ff7e323e4" name="Get Project Code" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="285" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Project Code&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Direct or Indirect /&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Project code" />
    </outputs>
    <onsuccess>532be1d1-2a9b-4fb9-9d58-0e8f0e57bf93</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="28c2c5a4-c433-488a-9bec-b8860813fd17" name="Project code" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-300" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="87754a55-b026-468c-9db3-c39f212a6c8d" name="Check Directory?" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="0" y="-375" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Name" narrative="The directory to check exists" expr="[Directory Path]" />
    </inputs>
    <outputs>
      <output type="flag" name="Exists" narrative="True if the directory exists" stage="Directory Exists" />
    </outputs>
    <onsuccess>8a09eb47-d050-4779-af9b-62a6471b9773</onsuccess>
    <resource object="Utility - File Management" action="Directory Exists" />
  </stage>
  <stage stageid="8a09eb47-d050-4779-af9b-62a6471b9773" name="If Directory Exist? " type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="0" y="-300" w="90" h="60" />
    <decision expression="[Directory Exists]" />
    <ontrue>3e28583d-b88a-42d8-a8ac-64dd78625a19</ontrue>
    <onfalse>5af1c51d-4647-435a-8eb3-92a5c27ccef6</onfalse>
  </stage>
  <stage stageid="3e28583d-b88a-42d8-a8ac-64dd78625a19" name="Delete Directory Files" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="150" y="-300" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Path" narrative="The path of the directory to delete" expr="[Directory Path]" />
      <input type="flag" name="Error If Not Exists" narrative="Set True to raise an error if the path does not exist" expr="" />
      <input type="flag" name="Recursive" narrative="Set True to delete all sub-directories of the path aswell" expr="True" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Error Message" />
    </outputs>
    <onsuccess>578d2778-aee6-463c-bd1e-ed02087d8f35</onsuccess>
    <resource object="Utility - File Management" action="Delete Directory" />
  </stage>
  <stage stageid="578d2778-aee6-463c-bd1e-ed02087d8f35" name="Create Directory" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="150" y="-225" w="120" h="60" />
    <inputs>
      <input type="text" name="Directory Path" narrative="The path in which to create the directory" expr="[Directory Path]" />
      <input type="flag" name="Error If Already Exists" narrative="True to generate an error if the directory already exists" expr="" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" narrative="True if successful" stage="Success" />
      <output type="text" name="Message" narrative="An error message if unsuccessful" stage="Error Message" />
    </outputs>
    <onsuccess>ed52196c-7067-4e49-bd37-8b954b4536e1</onsuccess>
    <resource object="Utility - File Management" action="Create Directory" />
  </stage>
  <stage stageid="66da6f61-2116-4b55-a770-7d437e9734b9" name="Sleep" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="-180" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="1" />
    </inputs>
    <onsuccess>8827b8ab-8f31-4604-82a2-912955ace5cd</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="5af1c51d-4647-435a-8eb3-92a5c27ccef6" name="Anchor6" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-225" w="10" h="10" />
    <onsuccess>578d2778-aee6-463c-bd1e-ed02087d8f35</onsuccess>
  </stage>
  <stage stageid="ed52196c-7067-4e49-bd37-8b954b4536e1" name="Anchor1" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="-180" w="10" h="10" />
    <onsuccess>66da6f61-2116-4b55-a770-7d437e9734b9</onsuccess>
  </stage>
  <stage stageid="577c2906-fd83-4656-a64c-e5bacb3816f1" name="Directory Exists" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="480" y="-300" w="90" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="56e68c46-9599-496f-beab-e8ccbe3cd7c9" name="Check Vendor Name 911 Secure?" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="570" y="75" w="90" h="60" />
    <decision expression="[Vendor name]=&quot;911 Secure&quot;" />
    <ontrue>4b346888-bb2e-4cb8-adf7-fe7239d56e26</ontrue>
    <onfalse>7696fe93-c281-40a8-91d5-4ba2cf2f989b</onfalse>
  </stage>
  <stage stageid="4b346888-bb2e-4cb8-adf7-fe7239d56e26" name="Set to 911 Secure LLC" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="75" />
    <onsuccess>502fe467-b9aa-4563-bf85-25a1cf52c5b9</onsuccess>
    <calculation expression="&quot;911 SECURE LLC&quot;" stage="Vendor name" />
  </stage>
  <stage stageid="502fe467-b9aa-4563-bf85-25a1cf52c5b9" name="Anchor13" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="210" w="10" h="10" />
    <onsuccess>7696fe93-c281-40a8-91d5-4ba2cf2f989b</onsuccess>
  </stage>
  <stage stageid="52b5e904-09ae-4005-98df-0d3157e3cec7" name="Check Vendor Name Exists?" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="75" w="90" h="60" />
    <decision expression="[Vendor name]=&quot;&quot;" />
    <ontrue>9564a839-8fbe-4021-acf4-9e8a0c31ab89</ontrue>
    <onfalse>56e68c46-9599-496f-beab-e8ccbe3cd7c9</onfalse>
  </stage>
  <stage stageid="c1e634aa-ca83-4030-9aae-38dfd4ff3aab" name="Anchor3" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="210" w="10" h="10" />
    <onsuccess>f63e088d-332d-4259-a2d0-23ee115d4dd0</onsuccess>
  </stage>
  <stage stageid="9564a839-8fbe-4021-acf4-9e8a0c31ab89" name="Vendor Name not found" type="Exception">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="30" w="90" h="30" />
    <exception localized="yes" type="Business Exception" detail="&quot;Third Party Supplier Name doesn't exits in the mail&quot;" />
  </stage>
  <stage stageid="7696fe93-c281-40a8-91d5-4ba2cf2f989b" name="Anchor14" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="570" y="210" w="10" h="10" />
    <onsuccess>c1e634aa-ca83-4030-9aae-38dfd4ff3aab</onsuccess>
  </stage>
  <stage stageid="4097ce22-b059-4fc0-acfe-4e1eee3c983b" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="-15" y="870" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>075e3e57-3049-4f80-84de-a82df3f3af81</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="ed617345-a1b5-42db-bd4e-b66115bf8fea" name="Item in Queue" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-405" y="165" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="39d4a89d-dc93-4237-88df-ee798e990bff" name="Item ID New" type="Collection">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-330" y="105" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Item ID" type="text" description="The Item ID of the work queue item" />
    </collectioninfo>
  </stage>
  <stage stageid="2fb1697d-6978-4b94-a226-01176e27fec0" name="Anchor16" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="150" y="870" w="10" h="10" />
    <onsuccess>4097ce22-b059-4fc0-acfe-4e1eee3c983b</onsuccess>
  </stage>
  <stage stageid="075e3e57-3049-4f80-84de-a82df3f3af81" name="Check Item In Queue" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="945" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>8627cd3f-5aa5-4de6-ad5f-e7b522dfa271</ontrue>
    <onfalse>88eb88fe-0a98-456f-8a58-fb64e0092c4d</onfalse>
  </stage>
  <stage stageid="bab57183-d7f1-45a8-a3bc-b553efda650f" name="Get Third Party Supplier Block" type="Block">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-135" y="0" w="855" h="225" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="a4b8e3ae-7763-4c30-a23c-f1a5a2cc02b4" name="Recover" type="Recover">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="150" y="165" w="120" h="60" />
    <onsuccess>c1e52376-fc0f-4300-bc8a-b928c29b9002</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="5460b4e9-847d-42e2-aba9-1caf00a0b892" name="Resume" type="Resume">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="390" y="165" w="90" h="60" />
    <onsuccess>b0bf64fd-dab4-4bdb-8e3b-2da6cb20d593</onsuccess>
  </stage>
  <stage stageid="c1e52376-fc0f-4300-bc8a-b928c29b9002" name="Set to Exception Detail" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="270" y="165" />
    <onsuccess>5460b4e9-847d-42e2-aba9-1caf00a0b892</onsuccess>
    <calculation expression="ExceptionDetail()&amp;&quot;;&quot;&amp;&quot;Can't able to get third party supplier in the email&quot;" stage="Exception Message" />
  </stage>
  <stage stageid="cf8280d4-e13c-43e3-a416-7ebf0cc9443a" name="Exception Message" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-345" y="165" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f481bd62-6ebd-464a-a0d5-b50bb0875cbf" name="SubFolder Exception Name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-435" y="-555" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Inbox</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="58b4c97c-c2b4-47be-8e19-09e887669985" name="Credentials::Get" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="150" y="-945" w="120" h="60" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;GSO Mailbox&quot;" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>58687617-c680-4c83-b694-a67a24aa666d</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="cfc575dd-b717-4d80-aa1d-9258225bc804" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="1110" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Completed&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>e67db3e2-0cb6-4dc6-aafa-0f50b3242792</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="e67db3e2-0cb6-4dc6-aafa-0f50b3242792" name="Setting the ID" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="390" y="1245" w="120" h="60" />
    <onsuccess>b3c3a5ed-8bb3-4407-89c6-2424e90084c6</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="4fe6ee92-3cf0-4886-97ac-4d6db07d98af" name="Sender Name" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-390" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="5137ff1a-b543-49c0-8d7e-6c63c2c2d876" name="Subject Flag" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-390" y="210" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="50b67f02-9d32-4fdf-934e-b2267fa7f8cb" name="Anchor19" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="420" w="10" h="10" />
    <onsuccess>93802483-b9e6-45ae-abf9-1c40d070b3d9</onsuccess>
  </stage>
  <stage stageid="532be1d1-2a9b-4fb9-9d58-0e8f0e57bf93" name="Choice1" type="ChoiceStart">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="390" />
    <groupid>eb7a6d92-1dbd-4f9d-b6ac-575bcbe71615</groupid>
    <choices>
      <choice expression="StartsWith(Trim([Subject]),&quot;RE:&quot;) OR StartsWith(Trim([Subject]),&quot;Re:&quot;)">
        <name>RE</name>
        <distance>30</distance>
        <ontrue>7654b6f1-5a21-4d84-8df5-72286a6666b6</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;FW:&quot;) OR StartsWith(Trim([Subject]),&quot;Fw:&quot;)">
        <name>FW</name>
        <distance>75</distance>
        <ontrue>14a97ec8-de1d-4ca4-aea1-e1e3dcb8bd11</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;Automatic reply:&quot;) OR StartsWith(Trim([Subject]),&quot;AUTOMATIC REPLY:&quot;)">
        <name>Automatic Reply</name>
        <distance>120</distance>
        <ontrue>7e076e17-32c9-4640-a463-2b8bec499470</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="f9b04f4b-d3cd-4a72-a4c6-6773122f7581" name="Otherwise1" type="ChoiceEnd">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="555" />
    <onsuccess>ce93da3b-30bb-4093-ae2f-a06763633b4c</onsuccess>
    <groupid>eb7a6d92-1dbd-4f9d-b6ac-575bcbe71615</groupid>
  </stage>
  <stage stageid="93802483-b9e6-45ae-abf9-1c40d070b3d9" name="Anchor18" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="465" w="10" h="10" />
    <onsuccess>b543f433-1a5d-4d01-afb4-a0b459f1bb77</onsuccess>
  </stage>
  <stage stageid="b543f433-1a5d-4d01-afb4-a0b459f1bb77" name="Anchor23" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="510" w="10" h="10" />
    <onsuccess>8c40cbea-6274-4338-a1c5-e343dd3b635d</onsuccess>
  </stage>
  <stage stageid="a087f9ab-102c-4f2d-bca1-18191ce68312" name="Sender Email Address" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-270" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="9a7e84fd-7f58-4c64-b319-b425fadb7c07" name="Work Queues::Add To Queue" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <narrative>The Data collection contains the items to be added to the queue. The collection may contain single or multiple rows, with each representing an item to be added.

If there is a failure during the process, the queue will be unchanged - i.e. no rows will be loaded even if the error occurred on the last one.

If Defer Until is specified, the items will not be available to be worked until then. Otherwise, they are available immediately.

If the queue has a key field defined, an item added has key data longer than the maximum permitted 255 characters, an error will occur</narrative>
    <display x="525" y="855" w="90" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to add items to" expr="[Work Queue Name]" />
      <input type="collection" name="Data" friendlyname="Data" narrative="A collection containing the data, one row for each item to be added" expr="[Input Collection]" />
      <input type="datetime" name="Defer Until" friendlyname="Defer Until" narrative="Optionally, the date/time the new item(s) should be deferred until" expr="" />
      <input type="number" name="Priority" friendlyname="Priority" narrative="Optionally, the priority for the new item(s). Lower numbers represent higher priorities. The default is 0." expr="" />
      <input type="text" name="Tags" friendlyname="Tags" narrative="Optionally, a semi-colon-separated set of tags to apply to the queue item(s)" expr="&quot;Ready to Start checking for vendor name&quot;" />
      <input type="text" name="Status" friendlyname="Status" narrative="Optionally, the initial status required of the work queue item(s) " expr="" />
      <input type="number" name="Batch Size" friendlyname="Batch Size" narrative="Optionally, the batch size to use when adding many items to the queue.  A Value of 0 will process all items in one batch.  An empty field will use the default batch size of 1000." expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The IDs of the items which have been added to the queue, in the order of the collection of data passed that was input" stage="Item IDs" />
    </outputs>
    <onsuccess>c1029b3a-bf87-45fd-a6fc-d3a05b8063e9</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Add To Queue" />
  </stage>
  <stage stageid="93052b1a-d64a-4a3c-b46e-8d3dc04ae83b" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="390" y="765" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>f00e691b-3d25-4b88-9583-fad234528539</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="f00e691b-3d25-4b88-9583-fad234528539" name="Check Item In Queue" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="855" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>bb360606-c360-4446-838b-0f438d217c04</ontrue>
    <onfalse>9a7e84fd-7f58-4c64-b319-b425fadb7c07</onfalse>
  </stage>
  <stage stageid="bb360606-c360-4446-838b-0f438d217c04" name="Anchor22" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="255" y="855" w="10" h="10" />
    <onsuccess>d0272607-f6b4-41aa-b3b6-932a4067f1f5</onsuccess>
  </stage>
  <stage stageid="d0272607-f6b4-41aa-b3b6-932a4067f1f5" name="Anchor25" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="255" y="1110" w="10" h="10" />
    <onsuccess>cfc575dd-b717-4d80-aa1d-9258225bc804</onsuccess>
  </stage>
  <stage stageid="c1029b3a-bf87-45fd-a6fc-d3a05b8063e9" name="Anchor26" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="525" y="930" w="10" h="10" />
    <onsuccess>291ebeab-fa16-4001-a863-cbcb74f26454</onsuccess>
  </stage>
  <stage stageid="cb37fa0f-f3b1-4809-b275-c0028ef4a8e5" name="New Item ID" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="810" y="105" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a944e260-bee9-4ace-9923-285f4be05508" name="Work Queues::Mark Exception" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <narrative>Marks the item as an exception, optionally retrying it by cloning the item and returning the ID of the clone. The item must be 'owned' by the calling process - i.e. it must have been retrieved using Get Next Item.</narrative>
    <display x="810" y="1110" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item to mark" expr="[Item IDs.Item ID]" />
      <input type="text" name="Exception Reason" friendlyname="Exception Reason" narrative="A description of the reason for the exception" expr="&quot;Mail ID Grid not Valid&quot;" />
      <input type="flag" name="Retry" friendlyname="Retry" narrative="Whether or not to retry the item, up to the maximum number of attempts specified for the queue. Optional - if not specified, the item will be retried" expr="" />
      <input type="flag" name="Keep Locked" friendlyname="Keep Locked" narrative="Whether or not the clone of the item should remain locked after the exception has been registered and the item is retried. Optional - default is False" expr="" />
    </inputs>
    <outputs>
      <output type="text" name="New Item ID" friendlyname="New Item ID" narrative="The Item ID of the newly cloned item. This item will be locked if 'Keep Locked' is True. This will be empty if no item was cloned (ie. the item was not retried." stage="New Item ID" />
    </outputs>
    <onsuccess>24168d09-217a-49f4-adfc-3022591be08c</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Mark Exception" />
  </stage>
  <stage stageid="8627cd3f-5aa5-4de6-ad5f-e7b522dfa271" name="Anchor27" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="945" w="10" h="10" />
    <onsuccess>b3c3a5ed-8bb3-4407-89c6-2424e90084c6</onsuccess>
  </stage>
  <stage stageid="10cb3072-b981-4cb1-9ba3-2e0674209420" name="Work Queues::Untag Item" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <narrative>Removes a tag from a work queue item</narrative>
    <display x="390" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the queue item to remove the tag from" expr="[Item IDs.Item ID]" />
      <input type="text" name="Tag" friendlyname="Tag" narrative="The tag to remove from the item. Note that this cannot start with a '+' (plus) or '-' (minus) character, and cannot contain ';' (semi-colon) characters" expr="&quot;Ready to start checking for vendor name&quot;" />
    </inputs>
    <onsuccess>b502218c-bfec-43e4-8fe8-2eaf696ea264</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Untag Item" />
  </stage>
  <stage stageid="a14c8395-884f-434a-934b-a99a07116d9d" name="Work Queues::Get Item By ID" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <narrative>This action gets the item corresponding to the Id</narrative>
    <display x="810" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue." expr="[Work Queue Name]" />
      <input type="text" name="Item ID" friendlyname="Item ID" narrative="The Id of the queue item" expr="[Item ID New.Item ID]" />
    </inputs>
    <outputs>
      <output type="text" name="Item ID" friendlyname="Item ID" narrative="The ID of the item retrieved - empty if there are none available." stage="Item ID" />
      <output type="collection" name="Data" friendlyname="Data" narrative="The data associated with the item - a single collection row." stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status of the item." stage="" />
      <output type="number" name="Attempts" friendlyname="Attempts" narrative="The number of attempts already made to work this item." stage="" />
    </outputs>
    <onsuccess>a944e260-bee9-4ace-9923-285f4be05508</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Get Item By ID" />
  </stage>
  <stage stageid="ef4c26be-fd2e-4c47-811b-77d777c83f72" name="Check Item In Queue" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="675" y="1005" w="90" h="60" />
    <decision expression="[Item in Queue]=True" />
    <ontrue>a14c8395-884f-434a-934b-a99a07116d9d</ontrue>
    <onfalse>24168d09-217a-49f4-adfc-3022591be08c</onfalse>
  </stage>
  <stage stageid="b502218c-bfec-43e4-8fe8-2eaf696ea264" name="Work Queues::Is Item In Queue" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <narrative>Check if an item with the given key is already in the queue</narrative>
    <display x="540" y="1005" w="120" h="60" />
    <inputs>
      <input type="text" name="Queue Name" friendlyname="Queue Name" narrative="The name of the queue to check" expr="[Work Queue Name]" />
      <input type="text" name="Key" friendlyname="Key" narrative="The key to check." expr="[Input Collection.Item Key]" />
      <input type="flag" name="Include Pending" friendlyname="Include Pending" narrative="Check any items in the queue which are currently awaiting being worked. This will include any deferred items which have a deferral date in the past and any locked items. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Deferred" friendlyname="Include Deferred" narrative="Check any items in the queue which are currently deferred to a later date. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Completed" friendlyname="Include Completed" narrative="Check any items in the queue which are completed. Optional - Default is True" expr="True" />
      <input type="flag" name="Include Terminated" friendlyname="Include Terminated" narrative="Check any items in the queue which have been fully terminated. Optional - Default is True" expr="False" />
    </inputs>
    <outputs>
      <output type="collection" name="Item IDs" friendlyname="Item IDs" narrative="The Item IDs which represent the work items found with the given key" stage="Item ID New" />
      <output type="flag" name="Result" friendlyname="Result" narrative="True if an item with the given key is in the queue, False otherwise." stage="Item in Queue" />
    </outputs>
    <onsuccess>ef4c26be-fd2e-4c47-811b-77d777c83f72</onsuccess>
    <resource object="Blueprism.Automate.clsWorkQueuesActions" action="Is Item In Queue" />
  </stage>
  <stage stageid="7654b6f1-5a21-4d84-8df5-72286a6666b6" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="420" />
    <onsuccess>50b67f02-9d32-4fdf-934e-b2267fa7f8cb</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;RE:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="14a97ec8-de1d-4ca4-aea1-e1e3dcb8bd11" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="465" />
    <onsuccess>93802483-b9e6-45ae-abf9-1c40d070b3d9</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;FW:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="7e076e17-32c9-4640-a463-2b8bec499470" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="510" />
    <onsuccess>b543f433-1a5d-4d01-afb4-a0b459f1bb77</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;AUTOMATIC REPLY:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="2018d80d-67ea-4290-986f-1535e9414ea1" name="Anchor19" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="435" w="10" h="10" />
    <onsuccess>6959cf55-5ec3-4595-946e-cfdf7e9eac8d</onsuccess>
  </stage>
  <stage stageid="ca3c363a-300d-4769-bc04-bb4f1db83cf8" name="Choice1" type="ChoiceStart">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="405" />
    <groupid>5f21627d-b26c-411b-8340-ceee662ca709</groupid>
    <choices>
      <choice expression="StartsWith(Trim([Subject]),&quot;RE:&quot;) OR StartsWith(Trim([Subject]),&quot;Re:&quot;)">
        <name>RE</name>
        <distance>30</distance>
        <ontrue>19e88f1e-30d5-496e-8fe2-5c43700cf2d1</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;FW:&quot;) OR StartsWith(Trim([Subject]),&quot;Fw:&quot;)">
        <name>FW</name>
        <distance>75</distance>
        <ontrue>e7863698-f6f4-4852-83e9-871eae4dd5bb</ontrue>
      </choice>
      <choice expression="StartsWith(Trim([Subject]),&quot;Automatic reply:&quot;) OR StartsWith(Trim([Subject]),&quot;AUTOMATIC REPLY:&quot;)">
        <name>Automatic Reply</name>
        <distance>115</distance>
        <ontrue>9ab03de5-2bbd-48ae-9552-756ed7c50b23</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="a98b3018-368e-4663-84b3-52fa27966fba" name="Otherwise1" type="ChoiceEnd">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="570" />
    <onsuccess>7fba1236-3dba-46ce-afc4-5533cd76da60</onsuccess>
    <groupid>5f21627d-b26c-411b-8340-ceee662ca709</groupid>
  </stage>
  <stage stageid="6959cf55-5ec3-4595-946e-cfdf7e9eac8d" name="Anchor18" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="480" w="10" h="10" />
    <onsuccess>6910167c-e079-467a-a455-08c83b6a4f9a</onsuccess>
  </stage>
  <stage stageid="6910167c-e079-467a-a455-08c83b6a4f9a" name="Anchor23" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="525" w="10" h="10" />
    <onsuccess>19cba9d7-2c1c-4ea5-af36-e36350da5eec</onsuccess>
  </stage>
  <stage stageid="19e88f1e-30d5-496e-8fe2-5c43700cf2d1" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="435" />
    <onsuccess>2018d80d-67ea-4290-986f-1535e9414ea1</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;RE:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="e7863698-f6f4-4852-83e9-871eae4dd5bb" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="480" />
    <onsuccess>6959cf55-5ec3-4595-946e-cfdf7e9eac8d</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;FW:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="9ab03de5-2bbd-48ae-9552-756ed7c50b23" name="Assigning Subject" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="480" y="525" />
    <onsuccess>6910167c-e079-467a-a455-08c83b6a4f9a</onsuccess>
    <steps>
      <calculation expression="Upper([Subject])" stage="Subject" />
      <calculation expression="Replace([Subject], &quot;AUTOMATIC REPLY:&quot;, &quot; &quot;)" stage="Subject" />
    </steps>
  </stage>
  <stage stageid="f63e088d-332d-4259-a2d0-23ee115d4dd0" name="Anchor39" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="210" w="10" h="10" />
    <onsuccess>5ae84c34-c69d-4da9-9488-205ff7e323e4</onsuccess>
  </stage>
  <stage stageid="24168d09-217a-49f4-adfc-3022591be08c" name="Anchor17" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="675" y="1110" w="10" h="10" />
    <onsuccess>cfc575dd-b717-4d80-aa1d-9258225bc804</onsuccess>
  </stage>
  <stage stageid="256d4be2-1a30-4711-a624-0013519a5a8b" name="Block1" type="Block">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="810" w="1245" h="480" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="dfed07f8-9d29-4189-b420-2fe3f93deb68" name="Recover2" type="Recover">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="945" y="1215" w="120" h="60" />
    <onsuccess>3c697023-9edf-4db5-90ed-b80e0093df6e</onsuccess>
  </stage>
  <stage stageid="3c697023-9edf-4db5-90ed-b80e0093df6e" name="Resume2" type="Resume">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="945" y="1395" w="120" h="60" />
    <onsuccess>37745a18-b313-4672-8335-fe183d48ce87</onsuccess>
  </stage>
  <stage stageid="701c3e7b-27ad-4ea0-9178-53b40897753d" name="Anchor40" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="1395" w="10" h="10" />
    <onsuccess>b3c3a5ed-8bb3-4407-89c6-2424e90084c6</onsuccess>
  </stage>
  <stage stageid="37745a18-b313-4672-8335-fe183d48ce87" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="750" y="1395" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Exception&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>d27f4655-2b93-419b-9b8b-17d44a90d35d</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="d27f4655-2b93-419b-9b8b-17d44a90d35d" name="Setting the ID" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="540" y="1395" w="120" h="60" />
    <onsuccess>701c3e7b-27ad-4ea0-9178-53b40897753d</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="d75b9054-4ab0-4b8a-9581-90ab146cd756" name="Local Date Time" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-405" y="270" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="47a9a183-ca72-4eaa-b367-7d71e3e3597b" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="675" w="90" h="60" />
    <onsuccess>93052b1a-d64a-4a3c-b46e-8d3dc04ae83b</onsuccess>
    <steps>
      <calculation expression="Today()&amp;&quot;_&quot;&amp;LocalTime()" stage="Local Date Time" />
      <calculation expression="Trim([Subject])&amp;&quot;_&quot;&amp;[Local Date Time]" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="ce93da3b-30bb-4093-ae2f-a06763633b4c" name="Check GSO ?" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-15" y="615" />
    <decision expression="Trim([Subject])=&quot;GSO 3rd Party Approval&quot;" />
    <ontrue>9ea91966-e84d-4607-8979-9b8170305fdb</ontrue>
    <onfalse>74129be3-48b8-4ee4-96fd-d2bfbcf8f94b</onfalse>
  </stage>
  <stage stageid="8c40cbea-6274-4338-a1c5-e343dd3b635d" name="Anchor28" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="615" w="10" h="10" />
    <onsuccess>ce93da3b-30bb-4093-ae2f-a06763633b4c</onsuccess>
  </stage>
  <stage stageid="74129be3-48b8-4ee4-96fd-d2bfbcf8f94b" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-165" y="615" w="120" h="60" />
    <onsuccess>323469ba-127e-4b0a-a902-a64519f60386</onsuccess>
    <steps>
      <calculation expression="Trim(Lower([Vendor name]))" stage="Input Collection.Vendor Name" />
      <calculation expression="Trim([Project code])" stage="Input Collection.Project Code" />
      <calculation expression="Trim([Subject])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="7fba1236-3dba-46ce-afc4-5533cd76da60" name="Check GSO ?" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="615" />
    <decision expression="Trim([Subject])=&quot;GSO 3rd Party Approval&quot;" />
    <ontrue>47a9a183-ca72-4eaa-b367-7d71e3e3597b</ontrue>
    <onfalse>74085c4c-59c7-4700-b103-3a70c49ebf52</onfalse>
  </stage>
  <stage stageid="19cba9d7-2c1c-4ea5-af36-e36350da5eec" name="Anchor20" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="600" y="615" w="10" h="10" />
    <onsuccess>7fba1236-3dba-46ce-afc4-5533cd76da60</onsuccess>
  </stage>
  <stage stageid="74085c4c-59c7-4700-b103-3a70c49ebf52" name="Setting the values to input Collection" type="MultipleCalculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="270" y="615" w="90" h="60" />
    <onsuccess>93052b1a-d64a-4a3c-b46e-8d3dc04ae83b</onsuccess>
    <steps>
      <calculation expression="Trim([Subject])" stage="Input Collection.Item Key" />
    </steps>
  </stage>
  <stage stageid="1fa464e2-1299-4562-a1de-befe9b1f024e" name="Email - Exchange Managed API::Move Mail" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="-315" y="1095" w="120" h="60" />
    <inputs>
      <input type="text" name="ID" friendlyname="ID" expr="[ID]" />
      <input type="text" name="Move to Sub-Folder" friendlyname="Move to Sub-Folder" expr="&quot;GSO Completed&quot;" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="New Mail Id" friendlyname="New Mail Id" stage="New Mail Id" />
    </outputs>
    <onsuccess>edbc6c39-50e7-474c-bad2-be0b8b2b17fb</onsuccess>
    <resource object="Email - Exchange Managed API" action="Move Mail" />
  </stage>
  <stage stageid="edbc6c39-50e7-474c-bad2-be0b8b2b17fb" name="Setting the ID" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="1245" w="120" h="60" />
    <onsuccess>c47b5c3b-16ce-4b91-9fbb-b49f10b49848</onsuccess>
    <calculation expression="[New Mail Id]" stage="Input Collection.New Item ID" />
  </stage>
  <stage stageid="291ebeab-fa16-4001-a863-cbcb74f26454" name="Contruct and Send Email(Tabular Format)" type="SubSheet">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="930" w="120" h="60" />
    <inputs>
      <input type="text" name="Exception Message" friendlyname="Exception Message" expr="[Exception Message]" />
      <input type="text" name="Exception Type" friendlyname="Exception Type" expr="&quot;Business Exception&quot; " />
      <input type="number" name="Item Count" friendlyname="Item Count" expr="" />
      <input type="text" name="Excel Path" friendlyname="Excel Path" expr="[Excel Path]" />
      <input type="text" name="Sender Name" friendlyname="Sender Name" expr="[Sender Name]" />
      <input type="text" name="Sender Email Address" friendlyname="Sender Email Address" expr="Trim([Sender Email Address])" />
      <input type="text" name="Subject" friendlyname="Subject" expr="[Subject]" />
      <input type="flag" name="Project Code Flag" friendlyname="Project Code Flag" expr="" />
    </inputs>
    <onsuccess>10cb3072-b981-4cb1-9ba3-2e0674209420</onsuccess>
    <processid>2167e0d0-c563-4e25-82ce-25ce1ecc006d</processid>
  </stage>
  <stage stageid="b0bf64fd-dab4-4bdb-8e3b-2da6cb20d593" name="Get Vendor Name(Third-Party Supplier)" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="390" y="285" w="120" h="60" />
    <inputs>
      <input type="text" name="Input String" friendlyname="Input String" expr="[Message Body]" />
      <input type="text" name="Start String" friendlyname="Start String" expr="&quot;Name of Third-Party Supplier&quot;" />
      <input type="text" name="End String" friendlyname="End String" expr="&quot;Project Code&quot;" />
    </inputs>
    <outputs>
      <output type="text" name="Result String" friendlyname="Result String" stage="Vendor name" />
    </outputs>
    <onsuccess>14c34b3a-96a3-4e57-825c-fdd294bd4ea6</onsuccess>
    <resource object="SubString VBO" action="Substring" />
  </stage>
  <stage stageid="9ccf2031-5a62-4fee-8af2-8af2a22f6ffb" name="Get Project Code Block" type="Block">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-135" y="240" w="855" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f247d533-04e0-4dc0-a886-eade3b7eaecf" name="Recover" type="Recover">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="540" y="300" w="120" h="60" />
    <onsuccess>629a6278-900b-4030-9bfd-c8560475f8f3</onsuccess>
    <breakpoint type="0">
      <condition>
      </condition>
    </breakpoint>
  </stage>
  <stage stageid="afff8ac2-8537-4e72-93ee-95a168c3cd71" name="Resume" type="Resume">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit />
    <display x="780" y="300" w="90" h="60" />
    <onsuccess>2a25948b-0b59-496f-a417-ed1d67535174</onsuccess>
  </stage>
  <stage stageid="629a6278-900b-4030-9bfd-c8560475f8f3" name="Set to Exception Detail" type="Calculation">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="660" y="300" />
    <onsuccess>afff8ac2-8537-4e72-93ee-95a168c3cd71</onsuccess>
    <calculation expression="ExceptionDetail()&amp;&quot;;&quot;&amp;&quot;Can't able to get third party supplier in the email&quot;" stage="Exception Message" />
  </stage>
  <stage stageid="2a25948b-0b59-496f-a417-ed1d67535174" name="Anchor34" type="Anchor">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="780" y="405" w="10" h="10" />
    <onsuccess>ca3c363a-300d-4769-bc04-bb4f1db83cf8</onsuccess>
  </stage>
  <stage stageid="14c34b3a-96a3-4e57-825c-fdd294bd4ea6" name="Check Vendor Name?" type="Decision">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="180" y="285" />
    <decision expression="[Vendor name]=&quot;&quot;" />
    <ontrue>78a67f7c-f534-4e1c-8382-47823b053dee</ontrue>
    <onfalse>5ae84c34-c69d-4da9-9488-205ff7e323e4</onfalse>
  </stage>
  <stage stageid="78a67f7c-f534-4e1c-8382-47823b053dee" name="Vendor Name not found" type="Exception">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="180" y="315" w="90" h="30" />
    <exception localized="yes" type="Business Exception" detail="&quot;Third Party Supplier Name doesn't exits in the mail&quot;" />
  </stage>
  <stage stageid="c28330e3-ab7b-4561-a46e-2261625db52f" name="sleep - 3" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-825" />
    <inputs>
      <input type="number" name="Sleep Time (Seconds)" friendlyname="Sleep Time (Seconds)" narrative="The time (in seconds) for which to sleep" expr="3" />
    </inputs>
    <onsuccess>3fae6642-50e3-4147-86e7-5dd71e0168f4</onsuccess>
    <resource object="Utility - General" action="Sleep" />
  </stage>
  <stage stageid="23e3f120-e244-40dd-9bc3-f18b0ce92efe" name="Loop Start2" type="LoopStart">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-645" w="90" h="30" />
    <onsuccess>a6424a7a-0288-426c-b403-43b450d4979e</onsuccess>
    <groupid>1bca6e68-9058-43a9-995c-84e5354e6328</groupid>
    <looptype>ForEach</looptype>
    <loopdata>IDs</loopdata>
  </stage>
  <stage stageid="6648de94-4dfd-434d-8ca5-6e5469cb112a" name="Loop End2" type="LoopEnd">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-510" w="90" h="30" />
    <groupid>1bca6e68-9058-43a9-995c-84e5354e6328</groupid>
  </stage>
  <stage stageid="a6424a7a-0288-426c-b403-43b450d4979e" name="Email - Exchange Managed API::Get Mail using ID" type="Action">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-585" w="120" h="60" />
    <inputs>
      <input type="text" name="Attachment Directory" friendlyname="Attachment Directory" expr="[Directory Path]" />
      <input type="text" name="Mail ID" friendlyname="Mail ID" expr="[IDs.ID]" />
    </inputs>
    <outputs>
      <output type="flag" name="Success" friendlyname="Success" stage="Success" />
      <output type="text" name="Error Message" friendlyname="Error Message" stage="Error Message" />
      <output type="text" name="Sender Name" friendlyname="Sender Name" stage="Sender Name" />
      <output type="text" name="Sender Email Address" friendlyname="Sender Email Address" stage="Sender Email Address" />
      <output type="text" name="Subject" friendlyname="Subject" stage="Subject" />
      <output type="text" name="Message Body" friendlyname="Message Body" stage="body data" />
      <output type="text" name="Attachment Names" friendlyname="Attachment Names" stage="" />
      <output type="text" name="ID" friendlyname="ID" stage="ID" />
    </outputs>
    <onsuccess>6648de94-4dfd-434d-8ca5-6e5469cb112a</onsuccess>
    <resource object="Email - Exchange Managed API" action="Get Mail using ID" />
  </stage>
  <stage stageid="2d47f1f2-2b7d-4d16-bce7-a105d02339a3" name="body data" type="Data">
    <subsheetid>f23ced7f-3421-4b49-8c98-300ca324b087</subsheetid>
    <display x="405" y="-570" w="90" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3098ac03-a2ab-4cf8-8826-8283fe4c0fdc" name="Populate Queue" type="SubSheet">
    <loginhibit onsuccess="true" />
    <display x="0" y="-405" w="120" h="60" />
    <onsuccess>54f3addb-4392-4ff2-aa2d-f6d65a6439b3</onsuccess>
    <processid>eddf0342-6873-42bd-88c6-0dd0c66abd06</processid>
  </stage>
  <stage stageid="1395239a-5056-4837-941d-d95e7b948ec0" name="check subject is null or empty" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="270" y="615" />
    <decision expression="Trim([Subject]) = &quot;&quot;" />
    <ontrue>b88294aa-65d4-44fb-a11d-6ed045d4dee8</ontrue>
    <onfalse>1d04bd2b-d461-41ac-af2f-80db31453c65</onfalse>
  </stage>
  <stage stageid="b88294aa-65d4-44fb-a11d-6ed045d4dee8" name="construct subject" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="270" y="675" />
    <onsuccess>9db67430-4fa2-4d78-a0eb-202bf3324ef1</onsuccess>
    <calculation expression="&quot;GSO 3rd Party approval&quot;" stage="Subject" />
  </stage>
  <stage stageid="1d04bd2b-d461-41ac-af2f-80db31453c65" name="Anchor10" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="210" y="615" w="10" h="10" />
    <onsuccess>2668cd23-199f-4f19-a2c9-0069c4154236</onsuccess>
  </stage>
  <stage stageid="2668cd23-199f-4f19-a2c9-0069c4154236" name="Anchor11" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="210" y="705" w="10" h="10" />
    <onsuccess>9db67430-4fa2-4d78-a0eb-202bf3324ef1</onsuccess>
  </stage>
  <stage stageid="8f498a9a-5787-451c-94ab-2bef0a083013" name="check subject is null or empty" type="Decision">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <display x="-195" y="615" />
    <decision expression="Trim([Subject]) = &quot;&quot;" />
    <ontrue>8411ce69-63be-4c08-ac62-2997c04e9c59</ontrue>
    <onfalse>9cf250d6-0c72-45af-ba53-b692f8e6c94b</onfalse>
  </stage>
  <stage stageid="8411ce69-63be-4c08-ac62-2997c04e9c59" name="construct subject" type="Calculation">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="675" />
    <onsuccess>3e55d156-f8a6-4631-b36a-90c2ffb9ab21</onsuccess>
    <calculation expression="&quot;GSO 3rd Party approval&quot;" stage="Subject" />
  </stage>
  <stage stageid="9cf250d6-0c72-45af-ba53-b692f8e6c94b" name="Anchor10" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="615" w="10" h="10" />
    <onsuccess>d2e8be15-75f2-4dfd-aca0-7bfe755917bf</onsuccess>
  </stage>
  <stage stageid="d2e8be15-75f2-4dfd-aca0-7bfe755917bf" name="Anchor11" type="Anchor">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-255" y="705" w="10" h="10" />
    <onsuccess>3e55d156-f8a6-4631-b36a-90c2ffb9ab21</onsuccess>
  </stage>
  <stage stageid="650f9825-b451-4bbc-a14a-b7c52f534b6b" name="Mark Email As Read" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="390" y="1110" />
    <inputs>
      <input type="text" name="Message ID" friendlyname="Message ID" narrative="Unique message identifier" expr="[ID]" />
      <input type="flag" name="Set To Read" friendlyname="Set To Read" expr="True" />
    </inputs>
    <onsuccess>a37b7da8-a9ff-432b-b2a8-4d7ae125d636</onsuccess>
    <resource object="Email - Exchange Managed API" action="Mark Email As Read/Unread" />
  </stage>
  <stage stageid="1fb88fc5-7b07-40be-bd5f-259a8fc11807" name="Mark Email As Read" type="Action">
    <subsheetid>eddf0342-6873-42bd-88c6-0dd0c66abd06</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="1155" w="90" h="60" />
    <inputs>
      <input type="text" name="Message ID" friendlyname="Message ID" narrative="Unique message identifier" expr="[ID]" />
      <input type="flag" name="Set To Read" friendlyname="Set To Read" expr="True" />
    </inputs>
    <onsuccess>c5f2fef2-a5a6-4bef-b9f1-57d36ab55fbf</onsuccess>
    <resource object="Email - Exchange Managed API" action="Mark Email As Read/Unread" />
  </stage>
</process>